from math import sqrt, inf
from scipy.optimize import minimize
from sympy import nsimplify

# https://math.stackexchange.com/q/4774103

def fun(X):
    s, t = X[0], X[1]
    non_negative_coeffs = [ \
        54133868544*s**2 - 5801472768*s*t - 91110302976*s + 155361024*t**2 + 4882253376*t + 38335843392, \
        21743275008*s**2 - 2322692736*s*t - 37012440192*s + 62008128*t**2 + 1976537472*t + 15749557824, \
        189468539904*s**2 - 20305154688*s*t - 318886060416*s + 543763584*t**2 + 17087886816*t + 134175451872, \
        357335619520*s**2 - 38140168896*s*t - 601500057440*s + 1017035136*t**2 + 32102300592*t + 253123881868, \
        65229825024*s**2 - 6968078208*s*t - 111037320576*s + 186024384*t**2 + 5929612416*t + 47248673472, \
        387214941376*s**2 - 41333341920*s*t - 654167708144*s + 1102518144*t**2 + 34911651840*t + 276291794752, \
        1072006858560*s**2 - 114420506688*s*t - 1804500172320*s + 3051105408*t**2 + 96306901776*t + 759371645604, \
        968194684224*s**2 - 103052687808*s*t - 1629983400912*s + 2740065120*t**2 + 86753341992*t + 686025154368, \
        70825419184*s**2 - 7557382560*s*t - 120345663776*s + 201526416*t**2 + 6419431200*t + 51116981968, \
        494366003680*s**2 - 52570468080*s*t - 838204119320*s + 1396886400*t**2 + 44559412560*t + 355290857200, \
        1530755837664*s**2 - 162894125952*s*t - 2583342475968*s + 4331030652*t**2 + 137447890956*t + 1089937957920, \
        2420486710560*s**2 - 257631719520*s*t - 4074958502280*s + 6850162800*t**2 + 216883354980*t + 1715062885920, \
        1321869248112*s**2 - 140403040656*s*t - 2225387057856*s + 3725377344*t**2 + 118197672432*t + 936605518320, \
        32934463328*s**2 - 3501301440*s*t - 55629126592*s + 93012192*t**2 + 2956175040*t + 23486174816, \
        358355959840*s**2 - 38030002920*s*t - 607901957720*s + 1008483840*t**2 + 32250394800*t + 257794951840, \
        1274833577728*s**2 - 135087407424*s*t - 2159184664736*s + 3576885624*t**2 + 114384278952*t + 914256506500, \
        2501422046304*s**2 - 265334383320*s*t - 4220793147288*s + 7032071124*t**2 + 223858438368*t + 1780506240972, \
        2643738496224*s**2 - 280806081312*s*t - 4450774115712*s + 7450754688*t**2 + 236395344864*t + 1873211036640, \
        898366027968*s**2 - 95229546912*s*t - 1512152816688*s + 2521894752*t**2 + 80155425096*t + 636312101400, \
        5635838364*s**2 - 591462144*s*t - 9321851136*s + 15502032*t**2 + 488739888*t + 3851113344, \
        137902206032*s**2 - 14627113644*s*t - 233091847468*s + 387721152*t**2 + 12360123048*t + 98489296496, \
        633717593736*s**2 - 66938469372*s*t - 1074612412380*s + 1766941839*t**2 + 56747388654*t + 455554433679, \
        1331646358896*s**2 - 140369855460*s*t - 2256231218652*s + 3697943886*t**2 + 118904302572*t + 955696475538, \
        1774148208156*s**2 - 187331508468*s*t - 2994636232548*s + 4942759887*t**2 + 158104165986*t + 1263685212855, \
        1347549041952*s**2 - 142844320368*s*t - 2268229225032*s + 3782842128*t**2 + 120233137644*t + 954468152100, \
        241490204064*s**2 - 25540497936*s*t - 406358914320*s + 674908416*t**2 + 21491047440*t + 170942886000, \
        40244204*s**2 - 2157792*s*t - 13507936*s - 1078896*t - 17195152, \
        22193756648*s**2 - 2346549972*s*t - 37056459772*s + 62008128*t**2 + 1958806824*t + 15464142560, \
        174968614632*s**2 - 18464850108*s*t - 295770108732*s + 487016595*t**2 + 15606399474*t + 124988121363, \
        421600426848*s**2 - 44166344460*s*t - 715706719452*s + 1156472928*t**2 + 37486121820*t + 303736676796, \
        452278960044*s**2 - 46928467812*s*t - 769249174692*s + 1217382543*t**2 + 39906493554*t + 327079694535, \
        382141914840*s**2 - 39795735600*s*t - 646560725112*s + 1035984690*t**2 + 33665697504*t + 273485062350, \
        241490204064*s**2 - 25540497936*s*t - 406358914320*s + 674908416*t**2 + 21491047440*t + 170942886000, \
        75088*s**2 + 75088*s + 18772, \
        80888396*s**2 - 4315584*s*t - 27200704*s - 2157792*t - 34436512, \
        22060061932*s**2 - 2339128116*s*t - 36971610332*s + 62008128*t**2 + 1960383672*t + 15488863840, \
        69542043960*s**2 - 7275920304*s*t - 117646773360*s + 190251243*t**2 + 6155122314*t + 49754355339, \
        65055625320*s**2 - 6605325528*s*t - 111250146264*s + 167540841*t**2 + 5649635598*t + 47553723165, \
        -33520549572*s**2 + 3909518928*s*t + 54757841616*s - 112481343*t**2 - 3206007522*t - 22335494175, \
        -51013379556*s**2 + 5573736684*s*t + 85305549060*s - 151779069*t**2 - 4663062270*t - 35658181125, \
    ]
    non_positive_coeffs = [ \
        42841924608*s**2 - 4627343616*s*t - 72067801344*s + 124841808*t**2 + 3892235424*t + 30307625040, \
        -21956404224*s**2 + 2255405568*s*t + 36614625792*s - 57895344*t**2 - 1880148192*t - 15262935600, \
        42165348864*s**2 - 4672783488*s*t - 71235145344*s + 129082824*t**2 + 3946659024*t + 30086424456, \
        226227515648*s**2 - 24367540608*s*t - 380472651904*s + 655373160*t**2 + 20493028512*t + 159969638312, \
        -66138624000*s**2 + 6741109440*s*t + 110474306496*s - 171629640*t**2 - 5628529296*t - 46128756168, \
        -308787851584*s**2 + 32158663872*s*t + 517298276672*s - 837387603*t**2 - 26937220398*t - 216640970251, \
        58369907328*s**2 - 7015751136*s*t - 99614797824*s + 206895078*t**2 + 5977518408*t + 42495505602, \
        494381638080*s**2 - 53234162592*s*t - 831178753344*s + 1430855829*t**2 + 44757750102*t + 349348143429, \
        -72655125952*s**2 + 7299832800*s*t + 121477634528*s - 183018888*t**2 - 6100706352*t - 50775421096, \
        -688761474592*s**2 + 71570559132*s*t + 1154483059244*s - 1859550030*t**2 - 59981161104*t - 483760586386, \
        -1422977525088*s**2 + 148963827132*s*t + 2388147370644*s - 3898579581*t**2 - 125007725430*t - 1001956509717, \
        -265731065568*s**2 + 26587609140*s*t + 444685488372*s - 664424748*t**2 - 22238782788*t - 186023106504, \
        532542320160*s**2 - 57453130092*s*t - 894543881556*s + 1546738479*t**2 + 48266260842*t + 375641522835, \
        -34950581408*s**2 + 3409910400*s*t + 58415250112*s - 82730232*t**2 - 2848581840*t - 24409488632, \
        -542510360236*s**2 + 55718670204*s*t + 908536092596*s - 1430605683*t**2 - 46649399526*t - 380368905919, \
        -2265055946128*s**2 + 236608617924*s*t + 3801742049276*s - 6179362254*t**2 - 198571228092*t - 1595194825030, \
        -3049352645064*s**2 + 320222957100*s*t + 5123762275908*s - 8405253324*t**2 - 269053143288*t - 2152275340272, \
        -801123807984*s**2 + 83392752972*s*t + 1346452000212*s - 2170119978*t**2 - 70081887144*t - 565729709910, \
        272559727764*s**2 - 29532901176*s*t - 457075452744*s + 798193071*t**2 + 24772366098*t + 191613592575, \
        -6749920608*s**2 + 609890112*s*t + 11234369856*s - 13445640*t**2 - 507341952*t - 4675137720, \
        -185792596928*s**2 + 18630791760*s*t + 310412310760*s - 466466832*t**2 - 15557236860*t - 129654679196, \
        -1325454929628*s**2 + 137371353660*s*t + 2222702067612*s - 3559831587*t**2 - 115175004498*t - 931809358599, \
        -3372621400656*s**2 + 353461761960*s*t + 5666087064312*s - 9259778736*t**2 - 296930073552*t - 2379726775008, \
        -3227551913736*s**2 + 339847585488*s*t + 5427254390328*s - 8942818482*t**2 - 285761190996*t - 2281476293730, \
        -760719032208*s**2 + 80004831912*s*t + 1279759466448*s - 2102791392*t**2 - 67302213516*t - 538223166900, \
        51013379556*s**2 - 5573736684*s*t - 85305549060*s + 151779069*t**2 + 4663062270*t + 35658181125, \
        -272661248*s**2 + 14108640*s*t + 436657696*s - 11085360*t - 174417872, \
        -24554718656*s**2 + 2311109808*s*t + 40798100512*s - 53782560*t**2 - 1917367368*t - 16947493004, \
        -316118675136*s**2 + 32247994608*s*t + 529005674328*s - 822345264*t**2 - 26975377908*t - 221311851420, \
        -1318349613024*s**2 + 137410461312*s*t + 2213050753512*s - 3580722288*t**2 - 115332631044*t - 928710664920, \
        -2281222329504*s**2 + 239759152032*s*t + 3835015051512*s - 6297949008*t**2 - 201549665964*t - 1611739639140, \
        -1550333406816*s**2 + 163641654864*s*t + 2608077746808*s - 4316058864*t**2 - 137659431636*t - 1096846479900, \
        -241490204064*s**2 + 25540497936*s*t + 406358914320*s - 674908416*t**2 - 21491047440*t - 170942886000, \
        -490960*s**2 - 490960*s + 812972, \
        -541394816*s**2 + 28217280*s*t + 877243072*s - 22170720*t - 355339520, \
        -22659836800*s**2 + 2212349328*s*t + 37727749760*s - 53782560*t**2 - 1839769848*t - 15703804684, \
        -165426109824*s**2 + 17073964416*s*t + 277214950032*s - 440665056*t**2 - 14304045576*t - 116133624912, \
        -452392169232*s**2 + 47362775136*s*t + 760006689216*s - 1239529824*t**2 - 39786258552*t - 319188301320, \
        -550575196416*s**2 + 58013440704*s*t + 926000669232*s - 1527555744*t**2 - 48790859544*t - 389345214600, \
        -241490204064*s**2 + 25540497936*s*t + 406358914320*s - 674908416*t**2 - 21491047440*t - 170942886000, \
    ]
    v = 0
    for coeff in non_positive_coeffs:
        v += coeff**2 if coeff > 0 else 0
    for coeff in non_negative_coeffs:
        v += coeff**2 if coeff < 0 else 0
    return v

def main():
    min = inf
    initial_guesses = [0]
    ratio = 4
    for i in range(-5, 6):
        initial_guesses.append(-ratio**i)
        initial_guesses.insert(0, ratio**i)
    for s0 in initial_guesses:
        found = False
        for t0 in initial_guesses:
            print('Guess s0 =', s0, ', t0 =', t0, '...')
            result = minimize(fun, [s0, t0], \
                method = 'Nelder-Mead', options={'xatol': 1e-10, 'maxiter': 10000})
            # necessary to check result.success ? 
            if result.fun < min:
                min = result.fun
                s, t = result.x[0], result.x[1]
                print(result)
                print(s0, '->', s, ',', t0, '->', t)
                if result.fun < 2e-10:
                    found = True
                    break
        if found:
            break
    print('s =', nsimplify(s, tolerance = 0.001))
    print('t =', nsimplify(t, tolerance = 0.001))

if __name__ == '__main__':
    main()