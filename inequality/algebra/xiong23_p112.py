from math import inf
from sympy import *

# ISBN 9787542878021, p112, ยง7.2, ex6
# sum_cyc(a/(b**3 + 4)) >= ?

def main():
    w, x, y, z, v, p, q, r = symbols('w, x, y, z, v, p, q, r', negative = False)
    wxyz = (w + x + y + z)/4
    a, b, c, d = w/wxyz, x/wxyz, y/wxyz, z/wxyz
    print('a + b + c + d =', factor(a + b + c + d))
    f = a/(b**3 + 4) + b/(c**3 + 4) + c/(d**3 + 4) + d/(a**3 + 4) - v
    f = f.subs(x, w + p).subs(y, w + p + q).subs(z, w + p + q + r)
    print('f =', factor(f))
    # g <= 0
    g = 2146689*p**12*v - 1614177*p**12 + 17173512*p**11*q*v - 12667800*p**11*q + 8586756*p**11*r*v - 6467028*p**11*r + 31950720*p**11*v*w - 24270576*p**11*w + 63675432*p**10*q**2*v - 46147480*p**10*q**2 + 63675432*p**10*q*r*v - 46956568*p**10*q*r + 234305280*p**10*q*v*w - 175020208*p**10*q*w + 16448274*p**10*r**2*v - 12494050*p**10*r**2 + 117152640*p**10*r*v*w - 89230448*p**10*r*w + 218422800*p**10*v*w**2 - 167637280*p**10*w**2 + 144833984*p**9*q**3*v - 103301488*p**9*q**3 + 217250976*p**9*q**2*r*v - 157151888*p**9*q**2*r + 790228704*p**9*q**2*v*w - 581319872*p**9*q**2*w + 111714504*p**9*q*r**2*v - 83117480*p**9*q*r**2 + 790228704*p**9*q*r*v*w - 590733376*p**9*q*r*w + 1456152000*p**9*q*v*w**2 - 1101582704*p**9*q*w**2 + 19648756*p**9*r**3*v - 15208996*p**9*r**3 + 204465504*p**9*r**2*v*w - 157016256*p**9*r**2*w + 728076000*p**9*r*v*w**2 - 560907216*p**9*r*w**2 + 908170496*p**9*v*w**3 - 703834432*p**9*w**3 + 225289776*p**8*q**4*v - 158407968*p**8*q**4 + 450579552*p**8*q**3*r*v - 320346288*p**8*q**3*r + 1619409600*p**8*q**3*v*w - 1175029104*p**8*q**3*w + 346029048*p**8*q**2*r**2*v - 252598920*p**8*q**2*r**2 + 2429114400*p**8*q**2*r*v*w - 1785188496*p**8*q**2*r*w + 4422384576*p**8*q**2*v*w**2 - 3302219568*p**8*q**2*w**2 + 120739272*p**8*q*r**3*v - 91627896*p**8*q*r**3 + 1251264672*p**8*q*r**2*v*w - 943371648*p**8*q*r**2*w + 4422384576*p**8*q*r*v*w**2 - 3351543216*p**8*q*r*w**2 + 5449022976*p**8*q*v*w**3 - 4171979136*p**8*q*w**3 + 16159935*p**8*r**4*v - 12836031*p**8*r**4 + 220779936*p**8*r**3*v*w - 172592976*p**8*r**3*w + 1146042576*p**8*r**2*v*w**2 - 889935072*p**8*r**2*w**2 + 2724511488*p**8*r*v*w**3 - 2121581760*p**8*r*w**3 + 2560983552*p**8*v*w**4 - 2002110144*p**8*w**4 + 252652800*p**7*q**5*v - 175421952*p**7*q**5 + 631632000*p**7*q**4*r*v - 442258176*p**7*q**4*r + 2242286592*p**7*q**4*v*w - 1607190528*p**7*q**4*w + 644197632*p**7*q**3*r**2*v - 462267072*p**7*q**3*r**2 + 4484573184*p**7*q**3*r*v*w - 3245748864*p**7*q**3*r*w + 8063774208*p**7*q**3*v*w**2 - 5951468544*p**7*q**3*w**2 + 334664448*p**7*q**2*r**3*v - 249358656*p**7*q**2*r**3 + 3450100608*p**7*q**2*r**2*v*w - 2557461120*p**7*q**2*r**2*w + 12095661312*p**7*q**2*r*v*w**2 - 9030724992*p**7*q**2*r*w**2 + 14717775360*p**7*q**2*v*w**3 - 11145918208*p**7*q**2*w**3 + 88671120*p**7*q*r**4*v - 69119856*p**7*q*r**4 + 1207814016*p**7*q*r**3*v*w - 927809664*p**7*q*r**3*w + 6241019904*p**7*q*r**2*v*w**2 - 4768433088*p**7*q*r**2*w**2 + 14717775360*p**7*q*r*v*w**3 - 11298365440*p**7*q*r*w**3 + 13658578944*p**7*q*v*w**4 - 10571138560*p**7*q*w**4 + 9612552*p**7*r**5*v - 7853736*p**7*r**5 + 162347136*p**7*r**4*v*w - 130100640*p**7*r**4*w + 1104566400*p**7*r**3*v*w**2 - 872275392*p**7*r**3*w**2 + 3819729408*p**7*r**2*v*w**3 - 2997049600*p**7*r**2*w**3 + 6829289472*p**7*r*v*w**4 - 5368438016*p**7*r*w**4 + 5165445888*p**7*v*w**5 - 4067991040*p**7*w**5 + 209529856*p**6*q**6*v - 143889664*p**6*q**6 + 628589568*p**6*q**5*r*v - 434308608*p**6*q**5*r + 2203808256*p**6*q**5*v*w - 1562584320*p**6*q**5*w + 798520896*p**6*q**4*r**2*v - 564379776*p**6*q**4*r**2 + 5509520640*p**6*q**4*r*v*w - 3933788160*p**6*q**4*r*w + 9782350080*p**6*q**4*v*w**2 - 7145228544*p**6*q**4*w**2 + 549392512*p**6*q**3*r**3*v - 402596032*p**6*q**3*r**3 + 5629110528*p**6*q**3*r**2*v*w - 4109050176*p**6*q**3*r**2*w + 19564700160*p**6*q**3*r*v*w**2 - 14411652864*p**6*q**3*r*w**2 + 23503857664*p**6*q**3*v*w**3 - 17626337536*p**6*q**3*w**3 + 216289680*p**6*q**2*r**4*v - 165667440*p**6*q**2*r**4 + 2934145152*p**6*q**2*r**3*v*w - 2217246144*p**6*q**2*r**3*w + 15077769984*p**6*q**2*r**2*v*w**2 - 11348328768*p**6*q**2*r**2*w**2 + 35255786496*p**6*q**2*r*v*w**3 - 26713121792*p**6*q**2*r*w**3 + 32296717056*p**6*q**2*v*w**4 - 24771118592*p**6*q**2*w**4 + 46358352*p**6*q*r**5*v - 37210800*p**6*q*r**5 + 780875136*p**6*q*r**4*v*w - 615395616*p**6*q*r**4*w + 5295419904*p**6*q*r**3*v*w**2 - 4117765056*p**6*q*r**3*w**2 + 18220425216*p**6*q*r**2*v*w**3 - 14094338816*p**6*q*r**2*w**3 + 32296717056*p**6*q*r*v*w**4 - 25076825344*p**6*q*r*w**4 + 24105414144*p**6*q*v*w**5 - 18830392832*p**6*q*w**5 + 4238140*p**6*r**6*v - 3561628*p**6*r**6 + 85064064*p**6*r**5*v*w - 70063584*p**6*r**5*w + 714718752*p**6*r**4*v*w**2 - 577968576*p**6*r**4*w**2 + 3234248192*p**6*r**3*v*w**3 - 2577899008*p**6*r**3*w**3 + 8394203904*p**6*r**2*v*w**4 - 6645186816*p**6*r**2*w**4 + 12052707072*p**6*r*v*w**5 - 9548439552*p**6*r*w**5 + 7647997440*p**6*v*w**6 - 6058370304*p**6*w**6 + 129444864*p**5*q**7*v - 88059648*p**5*q**7 + 453057024*p**5*q**6*r*v - 309486336*p**5*q**6*r + 1569020928*p**5*q**6*v*w - 1101920256*p**5*q**6*w + 688437504*p**5*q**5*r**2*v - 480218880*p**5*q**5*r**2 + 4707062784*p**5*q**5*r*v*w - 3320886528*p**5*q**5*r*w + 8252697600*p**5*q**5*v*w**2 - 5972242176*p**5*q**5*w**2 + 588451200*p**5*q**4*r**3*v - 424902912*p**5*q**4*r**3 + 5990035968*p**5*q**4*r**2*v*w - 4312660224*p**5*q**4*r**2*w + 20631744000*p**5*q**4*r*v*w**2 - 15015119616*p**5*q**4*r*w**2 + 24469327872*p**5*q**4*v*w**3 - 18189566976*p**5*q**4*w**3 + 306207360*p**5*q**3*r**4*v - 230826528*p**5*q**3*r**4 + 4134967296*p**5*q**3*r**3*v*w - 3077752704*p**5*q**3*r**3*w + 21116782080*p**5*q**3*r**2*v*w**2 - 15675661056*p**5*q**3*r**2*w**2 + 48938655744*p**5*q**3*r*v*w**3 - 36641436672*p**5*q**3*r*w**3 + 44249017344*p**5*q**3*v*w**4 - 33662112000*p**5*q**3*w**4 + 97388352*p**5*q**2*r**5*v - 76889568*p**5*q**2*r**5 + 1635278400*p**5*q**2*r**4*v*w - 1268430336*p**5*q**2*r**4*w + 11043429120*p**5*q**2*r**3*v*w**2 - 8462231424*p**5*q**2*r**3*w**2 + 37779393024*p**5*q**2*r**2*v*w**3 - 28835983104*p**5*q**2*r**2*w**3 + 66373526016*p**5*q**2*r*v*w**4 - 50948826624*p**5*q**2*r*w**4 + 48881304576*p**5*q**2*v*w**5 - 37903580160*p**5*q**2*w**5 + 17596752*p**5*q*r**6*v - 14544336*p**5*q*r**6 + 352305216*p**5*q*r**5*v*w - 285586176*p**5*q*r**5*w + 2951842176*p**5*q*r**4*v*w**2 - 2351884320*p**5*q*r**4*w**2 + 13310065152*p**5*q*r**3*v*w**3 - 10465591296*p**5*q*r**3*w**3 + 34356920832*p**5*q*r**2*v*w**4 - 26860646400*p**5*q*r**2*w**4 + 48881304576*p**5*q*r*v*w**5 - 38315355648*p**5*q*r*w**5 + 30591989760*p**5*q*v*w**6 - 24079469568*p**5*q*w**6 + 1394952*p**5*r**7*v - 1204968*p**5*r**7 + 32371008*p**5*r**6*v*w - 27411264*p**5*r**6*w + 323074368*p**5*r**5*v*w**2 - 268303584*p**5*r**5*w**2 + 1803660288*p**5*r**4*v*w**3 - 1470396288*p**5*r**4*w**3 + 6116206080*p**5*r**3*v*w**4 - 4912253952*p**5*r**3*w**4 + 12723183360*p**5*r**2*v*w**5 - 10142427648*p**5*r**2*w**5 + 15295994880*p**5*r*v*w**6 - 12189405696*p**5*r*w**6 + 8381509632*p**5*v*w**7 - 6668120064*p**5*w**7 + 59069184*p**4*q**8*v - 39871232*p**4*q**8 + 236276736*p**4*q**7*r*v - 159888128*p**4*q**7*r + 808845312*p**4*q**7*v*w - 563334656*p**4*q**7*w + 417649152*p**4*q**6*r**2*v - 288132608*p**4*q**6*r**2 + 2830958592*p**4*q**6*r*v*w - 1976584192*p**4*q**6*r*w + 4902927360*p**4*q**6*v*w**2 - 3518689280*p**4*q**6*w**2 + 425978880*p**4*q**5*r**3*v - 303709952*p**4*q**5*r**3 + 4309083648*p**4*q**5*r**2*v*w - 3064860672*p**4*q**5*r**2*w + 14708782080*p**4*q**5*r*v*w**2 - 10589359872*p**4*q**5*r*w**2 + 17225035776*p**4*q**5*v*w**3 - 12702199808*p**4*q**5*w**3 + 274837536*p**4*q**4*r**4*v - 204274112*p**4*q**4*r**4 + 3695312640*p**4*q**4*r**3*v*w - 2713081088*p**4*q**4*r**3*w + 18750852864*p**4*q**4*r**2*v*w**2 - 13744903680*p**4*q**4*r**2*w**2 + 43062589440*p**4*q**4*r*v*w**3 - 31893045248*p**4*q**4*r*w**3 + 38433567744*p**4*q**4*v*w**4 - 29019270656*p**4*q**4*w**4 + 115366464*p**4*q**3*r**5*v - 89720480*p**4*q**3*r**5 + 1931656320*p**4*q**3*r**4*v*w - 1476322720*p**4*q**3*r**4*w + 12987068928*p**4*q**3*r**3*v*w**2 - 9814846976*p**4*q**3*r**3*w**2 + 44152123392*p**4*q**3*r**2*v*w**3 - 33280196864*p**4*q**3*r**2*w**3 + 76867135488*p**4*q**3*r*v*w**4 - 58378538752*p**4*q**3*r*w**4 + 55860062208*p**4*q**3*v*w**5 - 43020053504*p**4*q**3*w**5 + 30913008*p**4*q**2*r**6*v - 25157008*p**4*q**2*r**6 + 617651136*p**4*q**2*r**5*v*w - 493096032*p**4*q**2*r**5*w + 5159205504*p**4*q**2*r**4*v*w**2 - 4051657248*p**4*q**2*r**4*w**2 + 23165595648*p**4*q**2*r**3*v*w**3 - 17974810624*p**4*q**2*r**3*w**3 + 59439727872*p**4*q**2*r**2*v*w**4 - 45915288576*p**4*q**2*r**2*w**4 + 83790093312*p**4*q**2*r*v*w**5 - 65017491456*p**4*q**2*r*w**5 + 51722913792*p**4*q**2*v*w**6 - 40470227968*p**4*q**2*w**6 + 4846800*p**4*q*r**7*v - 4121392*p**4*q*r**7 + 112216512*p**4*q*r**6*v*w - 93582784*p**4*q*r**6*w + 1117134720*p**4*q*r**5*v*w**2 - 914476704*p**4*q*r**5*w**2 + 6218526720*p**4*q*r**4*v*w**3 - 5002757632*p**4*q*r**4*w**3 + 21006160128*p**4*q*r**3*v*w**4 - 16668383488*p**4*q*r**3*w**4 + 43441740288*p**4*q*r**2*v*w**5 - 34249457664*p**4*q*r**2*w**5 + 51722913792*p**4*q*r*v*w**6 - 40842234880*p**4*q*r*w**6 + 27938365440*p**4*q*v*w**7 - 22120542208*p**4*q*w**7 + 339855*p**4*r**8*v - 301615*p**4*r**8 + 8939712*p**4*r**7*v*w - 7779104*p**4*r**7*w + 103149600*p**4*r**6*v*w**2 - 88020544*p**4*r**6*w**2 + 683750400*p**4*r**5*v*w**3 - 571871104*p**4*r**5*w**3 + 2857822464*p**4*r**4*v*w**4 - 2344190336*p**4*r**4*w**4 + 7755854592*p**4*r**3*v*w**5 - 6262595584*p**4*r**3*w**5 + 13482926592*p**4*r**2*v*w**6 - 10798889728*p**4*r**2*w**6 + 13969182720*p**4*r*v*w**7 - 11176140800*p**4*r*w**7 + 6751383552*p**4*v*w**8 - 5386792960*p**4*w**8 + 19384320*p**3*q**9*v - 13004800*p**3*q**9 + 87229440*p**3*q**8*r*v - 58596352*p**3*q**8*r + 295550976*p**3*q**8*v*w - 204386304*p**3*q**8*w + 175736832*p**3*q**7*r**2*v - 120182272*p**3*q**7*r**2 + 1182203904*p**3*q**7*r*v*w - 818151424*p**3*q**7*r*w + 2024202240*p**3*q**7*v*w**2 - 1441929216*p**3*q**7*w**2 + 208008192*p**3*q**6*r**3*v - 146769408*p**3*q**6*r**3 + 2093119488*p**3*q**6*r**2*v*w - 1473210368*p**3*q**6*r**2*w + 7084707840*p**3*q**6*r*v*w**2 - 5051582464*p**3*q**6*r*w**2 + 8196653056*p**3*q**6*v*w**3 - 5999865856*p**3*q**6*w**3 + 159809280*p**3*q**5*r**4*v - 117356544*p**3*q**5*r**4 + 2141644800*p**3*q**5*r**3*v*w - 1553492480*p**3*q**5*r**3*w + 10802534400*p**3*q**5*r**2*v*w**2 - 7828710912*p**3*q**5*r**2*w**2 + 24589959168*p**3*q**5*r*v*w**3 - 18030776320*p**3*q**5*r*w**3 + 21671067648*p**3*q**5*v*w**4 - 16247347200*p**3*q**5*w**4 + 83038080*p**3*q**4*r**5*v - 63718656*p**3*q**4*r**5 + 1387991040*p**3*q**4*r**4*v*w - 1046643200*p**3*q**4*r**4*w + 9294566400*p**3*q**4*r**3*v*w**2 - 6934601216*p**3*q**4*r**3*w**2 + 31402770432*p**3*q**4*r**2*v*w**3 - 23393622016*p**3*q**4*r**2*w**3 + 54177669120*p**3*q**4*r*v*w**4 - 40736610304*p**3*q**4*r*w**4 + 38859878400*p**3*q**4*v*w**5 - 29732622336*p**3*q**4*w**5 + 29340928*p**3*q**3*r**6*v - 23538112*p**3*q**3*r**6 + 585811968*p**3*q**3*r**5*v*w - 461026688*p**3*q**3*r**5*w + 4880767488*p**3*q**3*r**4*v*w**2 - 3780368896*p**3*q**3*r**4*w**2 + 21822275584*p**3*q**3*r**3*v*w**3 - 16716181504*p**3*q**3*r**3*w**3 + 55645612032*p**3*q**3*r**2*v*w**4 - 42487966208*p**3*q**3*r**2*w**4 + 77719756800*p**3*q**3*r*v*w**5 - 59723825152*p**3*q**3*r*w**5 + 47329902592*p**3*q**3*v*w**6 - 36819800064*p**3*q**3*w**6 + 6824448*p**3*q**2*r**7*v - 5717568*p**3*q**2*r**7 + 157891968*p**3*q**2*r**6*v*w - 129751424*p**3*q**2*r**6*w + 1568938752*p**3*q**2*r**5*v*w**2 - 1266208896*p**3*q**2*r**5*w**2 + 8707736064*p**3*q**2*r**4*v*w**3 - 6912623872*p**3*q**2*r**4*w**3 + 29290748928*p**3*q**2*r**3*v*w**4 - 22960354304*p**3*q**2*r**3*w**4 + 60201584640*p**3*q**2*r**2*v*w**5 - 46943029248*p**3*q**2*r**2*w**5 + 70994853888*p**3*q**2*r*v*w**6 - 55554437120*p**3*q**2*r*w**6 + 37809831936*p**3*q**2*v*w**7 - 29794488320*p**3*q**2*w**7 + 948072*p**3*q*r**8*v - 828792*p**3*q*r**8 + 24892800*p**3*q*r**7*v*w - 21342080*p**3*q*r**7*w + 286588416*p**3*q*r**6*v*w**2 - 241118912*p**3*q*r**6*w**2 + 1894924800*p**3*q*r**5*v*w**3 - 1564137472*p**3*q*r**5*w**3 + 7896112128*p**3*q*r**4*v*w**4 - 6399555072*p**3*q*r**4*w**4 + 21341706240*p**3*q*r**3*v*w**5 - 17045543936*p**3*q*r**3*w**5 + 36868558848*p**3*q*r**2*v*w**6 - 29238130688*p**3*q*r**2*w**6 + 37809831936*p**3*q*r*v*w**7 - 30011588608*p**3*q*r*w**7 + 18003689472*p**3*q*v*w**8 - 14316105728*p**3*q*w**8 + 59636*p**3*r**9*v - 54404*p**3*r**9 + 1753344*p**3*r**8*v*w - 1567472*p**3*r**8*w + 22939776*p**3*r**7*v*w**2 - 20109760*p**3*r**7*w**2 + 175808000*p**3*r**6*v*w**3 - 150974720*p**3*r**6*w**3 + 872186880*p**3*r**5*v*w**4 - 733019392*p**3*r**5*w**4 + 2914998528*p**3*r**4*v*w**5 - 2399576576*p**3*r**4*w**5 + 6601803776*p**3*r**3*v*w**6 - 5345340416*p**3*r**3*w**6 + 9871466496*p**3*r**2*v*w**7 - 7925305344*p**3*r**2*w**7 + 9001844736*p**3*r*v*w**8 - 7217172480*p**3*r*w**8 + 3899719680*p**3*v*w**9 - 3116752896*p**3*w**9 + 4331520*p**2*q**10*v - 2893824*p**2*q**10 + 21657600*p**2*q**9*r*v - 14475264*p**2*q**9*r + 72769536*p**2*q**9*v*w - 50036736*p**2*q**9*w + 48960000*p**2*q**8*r**2*v - 33274368*p**2*q**8*r**2 + 327462912*p**2*q**8*r*v*w - 225017856*p**2*q**8*r*w + 555098112*p**2*q**8*v*w**2 - 392847360*p**2*q**8*w**2 + 65894400*p**2*q**7*r**3*v - 46130688*p**2*q**7*r**3 + 660750336*p**2*q**7*r**2*v*w - 461085696*p**2*q**7*r**2*w + 2220392448*p**2*q**7*r*v*w**2 - 1569933312*p**2*q**7*r*w**2 + 2540421120*p**2*q**7*v*w**3 - 1846861824*p**2*q**7*w**3 + 58626048*p**2*q**6*r**4*v - 42635520*p**2*q**6*r**4 + 784465920*p**2*q**6*r**3*v*w - 563251200*p**2*q**6*r**3*w + 3937867776*p**2*q**6*r**2*v*w**2 - 2825152512*p**2*q**6*r**2*w**2 + 8891473920*p**2*q**6*r*v*w**3 - 6460219392*p**2*q**6*r*w**3 + 7743148032*p**2*q**6*v*w**4 - 5765812224*p**2*q**6*w**4 + 36209664*p**2*q**5*r**5*v - 27466752*p**2*q**5*r**5 + 605339136*p**2*q**5*r**4*v*w - 451110144*p**2*q**5*r**4*w + 4042229760*p**2*q**5*r**3*v*w**2 - 2980941312*p**2*q**5*r**3*w**2 + 13581139968*p**2*q**5*r**2*v*w**3 - 10007126016*p**2*q**5*r**2*w**3 + 23229444096*p**2*q**5*r*v*w**4 - 17300957184*p**2*q**5*r*w**4 + 16453951488*p**2*q**5*v*w**5 - 12508016640*p**2*q**5*w**5 + 15819840*p**2*q**4*r**6*v - 12527232*p**2*q**4*r**6 + 316263168*p**2*q**4*r**5*v*w - 245654016*p**2*q**4*r**5*w + 2631700224*p**2*q**4*r**4*v*w**2 - 2012183808*p**2*q**4*r**4*w**2 + 11724165120*p**2*q**4*r**3*v*w**3 - 8871014400*p**2*q**4*r**3*w**3 + 29717968896*p**2*q**4*r**2*v*w**4 - 22436791296*p**2*q**4*r**2*w**4 + 41134878720*p**2*q**4*r*v*w**5 - 31311163392*p**2*q**4*r*w**5 + 24723529728*p**2*q**4*v*w**6 - 19120840704*p**2*q**4*w**6 + 4851840*p**2*q**3*r**7*v - 4008384*p**2*q**3*r**7 + 112431360*p**2*q**3*r**6*v*w - 91112256*p**2*q**3*r**6*w + 1116808704*p**2*q**3*r**5*v*w**2 - 889031424*p**2*q**3*r**5*w**2 + 6184667136*p**2*q**3*r**4*v*w**3 - 4845466368*p**2*q**3*r**4*w**3 + 20720197632*p**2*q**3*r**3*v*w**4 - 16044191232*p**2*q**3*r**3*w**4 + 42324406272*p**2*q**3*r**2*v*w**5 - 32639600640*p**2*q**3*r**2*w**5 + 49447059456*p**2*q**3*r*v*w**6 - 38341853184*p**2*q**3*r*w**6 + 25973981184*p**2*q**3*v*w**7 - 20366082048*p**2*q**3*w**7 + 1001160*p**2*q**2*r**8*v - 862584*p**2*q**2*r**8 + 26308224*p**2*q**2*r**7*v*w - 22233024*p**2*q**2*r**7*w + 302752512*p**2*q**2*r**6*v*w**2 - 251166528*p**2*q**2*r**6*w**2 + 1998572544*p**2*q**2*r**5*v*w**3 - 1627671552*p**2*q**2*r**5*w**3 + 8304751872*p**2*q**2*r**4*v*w**4 - 6646642176*p**2*q**2*r**4*w**4 + 22351730688*p**2*q**2*r**3*v*w**5 - 17647755264*p**2*q**2*r**3*w**5 + 38368972800*p**2*q**2*r**2*v*w**6 - 30114686976*p**2*q**2*r**2*w**6 + 38960971776*p**2*q**2*r*v*w**7 - 30670172160*p**2*q**2*r*w**7 + 18284249088*p**2*q**2*v*w**8 - 14484639744*p**2*q**2*w**8 + 125064*p**2*q*r**9*v - 112440*p**2*q*r**9 + 3673728*p**2*q*r**8*v*w - 3236784*p**2*q*r**8*w + 47987712*p**2*q*r**7*v*w**2 - 41478336*p**2*q*r**7*w**2 + 367011840*p**2*q*r**6*v*w**3 - 311002368*p**2*q*r**6*w**3 + 1816227072*p**2*q*r**5*v*w**4 - 1507772160*p**2*q*r**5*w**4 + 6051267072*p**2*q*r**4*v*w**5 - 4925922816*p**2*q*r**4*w**5 + 13645443072*p**2*q*r**3*v*w**6 - 10937321472*p**2*q*r**3*w**6 + 20267827200*p**2*q*r**2*v*w**7 - 16125468672*p**2*q*r**2*w**7 + 18284249088*p**2*q*r*v*w**8 - 14558834688*p**2*q*r*w**8 + 7799439360*p**2*q*v*w**9 - 6220234752*p**2*q*w**9 + 7122*p**2*r**10*v - 6690*p**2*r**10 + 231936*p**2*r**9*v*w - 213168*p**2*r**9*w + 3394512*p**2*r**8*v*w**2 - 3056928*p**2*r**8*w**2 + 29514240*p**2*r**7*v*w**3 - 26022912*p**2*r**7*w**3 + 169315584*p**2*r**6*v*w**4 - 145939200*p**2*r**6*w**4 + 671507712*p**2*r**5*v*w**5 - 565358592*p**2*r**5*w**5 + 1871368704*p**2*r**4*v*w**6 - 1541180160*p**2*r**4*w**6 + 3640418304*p**2*r**3*v*w**7 - 2947485696*p**2*r**3*w**7 + 4781481984*p**2*r**2*v*w**8 - 3839385600*p**2*r**2*w**8 + 3899719680*p**2*r*v*w**9 - 3128057856*p**2*r*w**9 + 1533542400*p**2*v*w**10 - 1226588160*p**2*w**10 + 589824*p*q**11*v - 393216*p*q**11 + 3244032*p*q**10*r*v - 2162688*p*q**10*r + 10838016*p*q**10*v*w - 7421952*p*q**10*w + 8128512*p*q**9*r**2*v - 5505024*p*q**9*r**2 + 54190080*p*q**9*r*v*w - 37048320*p*q**9*r*w + 91127808*p*q**9*v*w**2 - 64143360*p*q**9*w**2 + 12248064*p*q**8*r**3*v - 8530944*p*q**8*r**3 + 122683392*p*q**8*r**2*v*w - 85069824*p*q**8*r**2*w + 410075136*p*q**8*r*v*w**2 - 287932416*p*q**8*r*w**2 + 464683008*p*q**8*v*w**3 - 335724544*p*q**8*w**3 + 12364800*p*q**7*r**4*v - 8928000*p*q**7*r**4 + 165593088*p*q**7*r**3*v*w - 117952512*p*q**7*r**3*w + 828776448*p*q**7*r**2*v*w**2 - 589559808*p*q**7*r**2*w**2 + 1858732032*p*q**7*r*v*w**3 - 1339383808*p*q**7*r*w**3 + 1601323008*p*q**7*v*w**4 - 1184567296*p*q**7*w**4 + 8827392*p*q**6*r**5*v - 6633216*p*q**6*r**5 + 147950592*p*q**6*r**4*v*w - 109178880*p*q**6*r**4*w + 987033600*p*q**6*r**3*v*w**2 - 720562176*p*q**6*r**3*w**2 + 3302080512*p*q**6*r**2*v*w**3 - 2408943616*p*q**6*r**2*w**3 + 5604630528*p*q**6*r*v*w**4 - 4136615936*p*q**6*r*w**4 + 3923853312*p*q**6*v*w**5 - 2963292160*p*q**6*w**5 + 4578048*p*q**5*r**6*v - 3583744*p*q**5*r**6 + 91874304*p*q**5*r**5*v*w - 70541568*p*q**5*r**5*w + 765066240*p*q**5*r**4*v*w**2 - 578181888*p*q**5*r**4*w**2 + 3400679424*p*q**5*r**3*v*w**3 - 2543693824*p*q**5*r**3*w**3 + 8575819776*p*q**5*r**2*v*w**4 - 6404696064*p*q**5*r**2*w**4 + 11771559936*p*q**5*r*v*w**5 - 8876310528*p*q**5*r*w**5 + 6987743232*p*q**5*v*w**6 - 5370757120*p*q**5*w**6 + 1735296*p*q**4*r**7*v - 1414912*p*q**4*r**7 + 40389120*p*q**4*r**6*v*w - 32308480*p*q**4*r**6*w + 401923584*p*q**4*r**5*v*w**2 - 315848448*p*q**4*r**5*w**2 + 2224140288*p*q**4*r**4*v*w**3 - 1720566784*p*q**4*r**4*w**3 + 7427973120*p*q**4*r**3*v*w**4 - 5682202624*p*q**4*r**3*w**4 + 15086850048*p*q**4*r**2*v*w**5 - 11505266688*p*q**4*r**2*w**5 + 17469358080*p*q**4*r*v*w**6 - 13419839488*p*q**4*r*w**6 + 9056354304*p*q**4*v*w**7 - 7062077440*p*q**4*w**7 + 472512*p*q**3*r**8*v - 401392*p*q**3*r**8 + 12466176*p*q**3*r**7*v*w - 10389632*p*q**3*r**7*w + 143749632*p*q**3*r**6*v*w**2 - 117634816*p*q**3*r**6*w**2 + 949002240*p*q**3*r**5*v*w**3 - 762600448*p*q**3*r**5*w**3 + 3936242688*p*q**3*r**4*v*w**4 - 3109983488*p*q**3*r**4*w**4 + 10554433536*p*q**3*r**3*v*w**5 - 8233172992*p*q**3*r**3*w**5 + 18007523328*p*q**3*r**2*v*w**6 - 13980160000*p*q**3*r**2*w**6 + 18112708608*p*q**3*r*v*w**7 - 14133002240*p*q**3*r*w**7 + 8382185472*p*q**3*v*w**8 - 6610911232*p*q**3*w**8 + 87840*p*q**2*r**9*v - 77840*p*q**2*r**9 + 2587104*p*q**2*r**8*v*w - 2246976*p*q**2*r**8*w + 33834240*p*q**2*r**7*v*w**2 - 28836480*p*q**2*r**7*w**2 + 258737664*p*q**2*r**6*v*w**3 - 216282368*p*q**2*r**6*w**3 + 1278706176*p*q**2*r**5*v*w**4 - 1047774720*p*q**2*r**5*w**4 + 4249285632*p*q**2*r**4*v*w**5 - 3416914944*p*q**2*r**4*w**5 + 9541926912*p*q**2*r**3*v*w**6 - 7562670080*p*q**2*r**3*w**6 + 14080720896*p*q**2*r**2*v*w**7 - 11091111936*p*q**2*r**2*w**7 + 12573278208*p*q**2*r*v*w**8 - 9933987840*p*q**2*r*w**8 + 5283840000*p*q**2*v*w**9 - 4201512960*p*q**2*w**9 + 9960*p*q*r**10*v - 9224*p*q*r**10 + 324576*p*q*r**9*v*w - 294080*p*q*r**9*w + 4747968*p*q*r**8*v*w**2 - 4215792*p*q*r**8*w**2 + 41227776*p*q*r**7*v*w**3 - 35858432*p*q*r**7*w**3 + 236069376*p*q*r**6*v*w**4 - 200877056*p*q*r**6*w**4 + 933995520*p*q*r**5*v*w**5 - 777082368*p*q*r**5*w**5 + 2594617344*p*q*r**4*v*w**6 - 2113952768*p*q*r**4*w**6 + 5024366592*p*q*r**3*v*w**7 - 4028923904*p*q*r**3*w**7 + 6552649728*p*q*r**2*v*w**8 - 5217226752*p*q*r**2*w**8 + 5283840000*p*q*r*v*w**9 - 4212817920*p*q*r*w**9 + 2044723200*p*q*v*w**10 - 1633812480*p*q*w**10 + 516*p*r**11*v - 500*p*r**11 + 18528*p*r**10*v*w - 17536*p*r**10*w + 300768*p*r**9*v*w**2 - 278480*p*r**9*w**2 + 2928384*p*r**8*v*w**3 - 2651456*p*r**8*w**3 + 19072512*p*r**7*v*w**4 - 16861696*p*r**7*w**4 + 87495936*p*r**6*v*w**5 - 75421184*p*r**6*w**5 + 289299456*p*r**5*v*w**6 - 243106304*p*r**5*w**6 + 691974144*p*r**4*v*w**7 - 568262656*p*r**4*w**7 + 1180778496*p*r**3*v*w**8 - 953421824*p*r**3*w**8 + 1384120320*p*r**2*v*w**9 - 1109336064*p*r**2*w**9 + 1022361600*p*r*v*w**10 - 819363840*p*r*w**10 + 368640000*p*v*w**11 - 294912000*p*w**11 + 36864*q**12*v - 24576*q**12 + 221184*q**11*r*v - 147456*q**11*r + 737280*q**11*v*w - 503808*q**11*w + 608256*q**10*r**2*v - 411648*q**10*r**2 + 4055040*q**10*r*v*w - 2764800*q**10*r*w + 6782976*q**10*v*w**2 - 4755456*q**10*w**2 + 1013760*q**9*r**3*v - 704512*q**9*r**3 + 10174464*q**9*r**2*v*w - 7028736*q**9*r**2*w + 33914880*q**9*r*v*w**2 - 23691264*q**9*r*w**2 + 38141952*q**9*v*w**3 - 27410432*q**9*w**3 + 1143552*q**8*r**4*v - 822016*q**8*r**4 + 15372288*q**8*r**3*v*w - 10891264*q**8*r**3*w + 76898304*q**8*r**2*v*w**2 - 54349824*q**8*r**2*w**2 + 171638784*q**8*r*v*w**3 - 122814464*q**8*r*w**3 + 146522112*q**8*v*w**4 - 107716608*q**8*w**4 + 924672*q**7*r**5*v - 689920*q**7*r**5 + 15581184*q**7*r**4*v*w - 11412992*q**7*r**4*w + 104103936*q**7*r**3*v*w**2 - 75384832*q**7*r**3*w**2 + 347455488*q**7*r**2*v*w**3 - 251297792*q**7*r**2*w**3 + 586088448*q**7*r*v*w**4 - 428945408*q**7*r*w**4 + 406093824*q**7*v*w**5 - 304644096*q**7*w**5 + 553472*q**6*r**6*v - 429056*q**6*r**6 + 11182080*q**6*r**5*v*w - 8503296*q**6*r**5*w + 93416448*q**6*r**4*v*w**2 - 69900288*q**6*r**4*w**2 + 415113216*q**6*r**3*v*w**3 - 307339264*q**6*r**3*w**3 + 1042993152*q**6*r**2*v*w**4 - 771026944*q**6*r**2*w**4 + 1421328384*q**6*r*v*w**5 - 1061814272*q**6*r*w**5 + 834174976*q**6*v*w**6 - 636878848*q**6*w**6 + 248832*q**5*r**7*v - 200448*q**5*r**7 + 5835264*q**5*r**6*v*w - 4613632*q**5*r**6*w + 58328064*q**5*r**5*v*w**2 - 45306624*q**5*r**5*w**2 + 323211264*q**5*r**4*v*w**3 - 247115776*q**5*r**4*w**3 + 1077669888*q**5*r**3*v*w**4 - 814807040*q**5*r**3*w**4 + 2178736128*q**5*r**2*v*w**5 - 1643040768*q**5*r**2*w**5 + 2502524928*q**5*r*v*w**6 - 1903886336*q**5*r*w**6 + 1281490944*q**5*v*w**7 - 993067008*q**5*w**7 + 83760*q**4*r**8*v - 70176*q**4*r**8 + 2226432*q**4*r**7*v*w - 1831168*q**4*r**7*w + 25800960*q**4*r**6*v*w**2 - 20841472*q**4*r**6*w**2 + 170735616*q**4*r**5*v*w**3 - 135442432*q**4*r**5*w**3 + 708056064*q**4*r**4*v*w**4 - 552316416*q**4*r**4*w**4 + 1893519360*q**4*r**3*v*w**5 - 1458851840*q**4*r**3*w**5 + 3213336576*q**4*r**2*v*w**6 - 2466160640*q**4*r**2*w**6 + 3203727360*q**4*r*v*w**7 - 2476064768*q**4*r*w**7 + 1463156736*q**4*v*w**8 - 1147748352*q**4*w**8 + 20576*q**3*r**9*v - 17968*q**3*r**9 + 609984*q**3*r**8*v*w - 522352*q**3*r**8*w + 8013312*q**3*r**7*v*w**2 - 6735872*q**3*r**7*w**2 + 61431808*q**3*r**6*v*w**3 - 50658048*q**3*r**6*w**3 + 303765504*q**3*r**5*v*w**4 - 245592832*q**3*r**5*w**4 + 1008052224*q**3*r**4*v*w**5 - 800082944*q**3*r**4*w**5 + 2255798272*q**3*r**3*v*w**6 - 1765974016*q**3*r**3*w**6 + 3308814336*q**3*r**2*v*w**7 - 2577448960*q**3*r**2*w**7 + 2926313472*q**3*r*v*w**8 - 2291695616*q**3*r*w**8 + 1212416000*q**3*v*w**9 - 960102400*q**3*w**9 + 3480*q**2*r**10*v - 3176*q**2*r**10 + 113952*q**2*r**9*v*w - 101776*q**2*r**9*w + 1672128*q**2*r**8*v*w**2 - 1463856*q**2*r**8*w**2 + 14542848*q**2*r**7*v*w**3 - 12474368*q**2*r**7*w**3 + 83294976*q**2*r**6*v*w**4 - 69922816*q**2*r**6*w**4 + 329223168*q**2*r**5*v*w**5 - 270348288*q**2*r**5*w**5 + 912402432*q**2*r**4*v*w**6 - 734219264*q**2*r**4*w**6 + 1759494144*q**2*r**3*v*w**7 - 1394937856*q**2*r**3*w**7 + 2279374848*q**2*r**2*v*w**8 - 1796739072*q**2*r**2*w**8 + 1818624000*q**2*r*v*w**9 - 1439170560*q**2*r*w**9 + 693043200*q**2*v*w**10 - 552468480*q**2*w**10 + 360*q*r**11*v - 344*q*r**11 + 12960*q*r**10*v*w - 12096*q*r**10*w + 210624*q*r**9*v*w**2 - 192304*q*r**9*w**2 + 2050560*q*r**8*v*w**3 - 1831040*q*r**8*w**3 + 13342464*q*r**7*v*w**4 - 11637504*q*r**7*w**4 + 61109760*q*r**6*v*w**5 - 52003840*q*r**6*w**5 + 201590784*q*r**5*v*w**6 - 167398400*q*r**5*w**6 + 480632832*q*r**4*v*w**7 - 390475776*q*r**4*w**7 + 816218112*q*r**3*v*w**8 - 652791808*q*r**3*w**8 + 949616640*q*r**2*v*w**9 - 754925568*q*r**2*w**9 + 693043200*q*r*v*w**10 - 552468480*q*r*w**10 + 245760000*q*v*w**11 - 196608000*q*w**11 + 17*r**12*v - 17*r**12 + 672*r**11*v*w - 656*r**11*w + 12048*r**10*v*w**2 - 11488*r**10*w**2 + 130304*r**9*v*w**3 - 121280*r**9*w**3 + 951552*r**8*v*w**4 - 863168*r**8*w**4 + 4960512*r**7*v*w**5 - 4378624*r**7*w**5 + 18980352*r**6*v*w**6 - 16291072*r**6*w**6 + 53858304*r**5*v*w**7 - 44994560*r**5*w**7 + 112914432*r**4*v*w**8 - 92164096*r**4*w**8 + 171704320*r**3*v*w**9 - 137928704*r**3*w**9 + 181862400*r**2*v*w**10 - 145244160*r**2*w**10 + 122880000*r*v*w**11 - 98304000*r*w**11 + 40960000*v*w**12 - 32768000*w**12
    p0 = Poly(g, (p, q, r))
    min = inf
    for coeff in p0.coeffs():
        # print(coeff)
        m = solve(Eq(coeff, 0), v)[0]
        if m < min:
            min = m
    print('f >=', min)
    print('f =', factor(f.subs(v, min)))

    f = a/(b**3 + 4) + b/(c**3 + 4) + c/(d**3 + 4) + d/(a**3 + 4) - S(2)/3
    # assume w = min(w, x, y, z), equality occurs when w = 0 and p = 0 and r = 0
    # 0 = w = x < y = z, i.e. a = b = 0 and c = d = 1/2
    print('f(wxyz) =', factor(f.subs(x, w + p).subs(y, w + p + q).subs(z, w + p + q + r)))
    print('f(wxzy) =', factor(f.subs(x, w + p).subs(z, w + p + q).subs(y, w + p + q + r)))
    # and q = 0, i.e. w = y = x = z = 0, never occurs
    print('f(wyxz) =', factor(f.subs(y, w + p).subs(x, w + p + q).subs(z, w + p + q + r)))
    print('f(wyzx) =', factor(f.subs(y, w + p).subs(z, w + p + q).subs(x, w + p + q + r)))
    # 0 = w = z < x = y, i.e. a = d = 0 and b = c = 1/2
    print('f(wzxy) =', factor(f.subs(z, w + p).subs(x, w + p + q).subs(y, w + p + q + r)))
    print('f(wzyx) =', factor(f.subs(z, w + p).subs(y, w + p + q).subs(x, w + p + q + r)))

if __name__ == '__main__':
    main()