from sympy import *

# https://math.stackexchange.com/q/4746804

def main():
    a, b = symbols('a, b', positive = True)
    # a*b <= 1
    c = (1 - a*b)/(a + b)
    f = 1 + 36*(a*b*c)**2 - 21*a*b*c/(a + b + c)
    u, v = symbols('u, v', positive = True)
    s3 = 1/sqrt(3)
    # a <= b <= s3
    print('f(ab3) =', factor(f.subs(b, s3/(1 + u)).subs(a, s3/(1 + u + v))))
    # a <= s3 <= b <= 1/a, b <= 1 || 1 <= b ??
    print('f(a3b) =', factor(f.subs(b, s3 + (1/a - s3)/(1 + v)).subs(a, s3/(1 + u))))
    # why so hard to prove positive?
    # f(a3b) = (243*u**10*v**2 + 486*u**10*v + 243*u**10 + 324*u**9*v**3 + 3078*u**9*v**2 + 5184*u**9*v + 2430*u**9 + 243*u**8*v**4 + 2106*u**8*v**3 + 17658*u**8*v**2 + 24138*u**8*v + 11259*u**8 + 90*u**7*v**5 + 774*u**7*v**4 + 7326*u**7*v**3 + 58050*u**7*v**2 + 65664*u**7*v + 31752*u**7 + 12*u**6*v**6 + 240*u**6*v**5 + 507*u**6*v**4 + 18270*u**6*v**3 + 120159*u**6*v**2 + 116748*u**6*v + 60264*u**6 + 36*u**5*v**6 + 126*u**5*v**5 - 360*u**5*v**4 + 32670*u**5*v**3 + 163620*u**5*v**2 + 143028*u**5*v + 80352*u**5 + 60*u**4*v**6 - 144*u**4*v**5 + 228*u**4*v**4 + 39000*u**4*v**3 + 148656*u**4*v**2 + 123624*u**4*v + 76176*u**4 + 48*u**3*v**6 - 192*u**3*v**5 + 1440*u**3*v**4 + 29232*u**3*v**3 + 89328*u**3*v**2 + 75600*u**3*v + 50688*u**3 + 16*u**2*v**6 - 96*u**2*v**5 + 1200*u**2*v**4 + 12960*u**2*v**3 + 34464*u**2*v**2 + 31968*u**2*v + 22656*u**2 - 32*u*v**5 + 384*u*v**4 + 3168*u*v**3 + 8064*u*v**2 + 8640*u*v + 6144*u + 64*v**4 + 384*v**3 + 960*v**2 + 1152*v + 768)/...
    # s3 <= a <= b <= 1
    print('f(3ab1) =', factor(f.subs(b, s3 + (1 - s3)/(1 + u)).subs(a, s3 + (1 - s3)/(1 + u + v))))
    # s3 <= a <= 1 <= b <= 1/a
    print('f(3a1b) =', factor(f.subs(b, 1 + (1/a - 1)/(1 + v)).subs(a, s3 + (1 - s3)/(1 + u))))

if __name__ == '__main__':
    main()