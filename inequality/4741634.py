from sympy import *

# https://math.stackexchange.com/q/4741634

def main():
    a, b, c = symbols('a, b, c', negative = False)
    x, y, z = 2 - 4*b*c/(b + a)/(c + a), 2 - 4*c*a/(c + b)/(a + b), 2 - 4*a*b/(a + c)/(b + c)
    print('x**2 + y**2 + z**2 + x*y*z =', factor(x**2 + y**2 + z**2 + x*y*z))
    # not negative because x may be negative
    s, t, u, v = symbols('s, t, u, v', negative = False)
    print('x =', factor(x.subs(b, a*(1 + u)).subs(c, a*(1 + u + v))))
    print('y =', factor(y.subs(b, a*(1 + u)).subs(c, a*(1 + u + v))))
    print('z =', factor(z.subs(b, a*(1 + u)).subs(c, a*(1 + u + v))))
    # should restrict that x >= 0, i.e. u*(u + v) <= 2, or u <= sqrt(2) && v <= 2/u - u

    f = 4*(x*y + y*z + z*x - x*y*z) - (x*x*y + z)*(y*y*z + x)*(z*z*x + y)
    print('f(abc) =', factor(f.subs(b, a*(1 + u)).subs(c, a*(1 + u + v))))
    print('f(acb) =', factor(f.subs(c, a*(1 + u)).subs(b, a*(1 + u + v))))
    # f(abc)'s numerator
    g = 3008*u**18 + 27072*u**17*v + 38656*u**17 + 110544*u**16*v**2 + 331648*u**16*v + 224896*u**16 + 270720*u**15*v**3 + 1280640*u**15*v**2 + 1857024*u**15*v + 797696*u**15 + 442740*u**14*v**4 + 2937280*u**14*v**3 + 6844608*u**14*v**2 + 6454528*u**14*v + 2052480*u**14 + 509292*u**13*v**5 + 4446000*u**13*v**4 + 14840384*u**13*v**3 + 23092480*u**13*v**2 + 16610816*u**13*v + 4687104*u**13 + 422483*u**12*v**6 + 4664344*u**12*v**5 + 20993000*u**12*v**4 + 48114048*u**12*v**3 + 58633424*u**12*v**2 + 37465088*u**12*v + 11142400*u**12 + 254646*u**11*v**7 + 3463312*u**11*v**6 + 20302672*u**11*v**5 + 64696640*u**11*v**4 + 119006912*u**11*v**3 + 128822208*u**11*v**2 + 82041728*u**11*v + 26019584*u**11 + 110685*u**10*v**8 + 1822880*u**10*v**7 + 13668944*u**10*v**6 + 58775440*u**10*v**5 + 153938780*u**10*v**4 + 251437824*u**10*v**3 + 260554848*u**10*v**2 + 166711296*u**10*v + 51476160*u**10 + 33840*u**9*v**9 + 668760*u**9*v**8 + 6394296*u**9*v**7 + 36699504*u**9*v**6 + 132774460*u**9*v**5 + 308590624*u**9*v**4 + 468539520*u**9*v**3 + 466298816*u**9*v**2 + 283931200*u**9*v + 79669248*u**9 + 6909*u**8*v**10 + 164120*u**8*v**9 + 2035776*u**8*v**8 + 15711920*u**8*v**7 + 77567068*u**8*v**6 + 248663088*u**8*v**5 + 525978072*u**8*v**4 + 742557504*u**8*v**3 + 687792576*u**8*v**2 + 380010112*u**8*v + 93912704*u**8 + 846*u**7*v**11 + 24768*u**7*v**10 + 422368*u**7*v**9 + 4520864*u**7*v**8 + 30524552*u**7*v**7 + 133106496*u**7*v**6 + 382944224*u**7*v**5 + 737596864*u**7*v**4 + 952279424*u**7*v**3 + 796296064*u**7*v**2 + 387891328*u**7*v + 83288320*u**7 + 47*u**6*v**12 + 1904*u**6*v**11 + 53008*u**6*v**10 + 839472*u**6*v**9 + 7874500*u**6*v**8 + 46736416*u**6*v**7 + 181846192*u**6*v**6 + 471845056*u**6*v**5 + 822447808*u**6*v**4 + 954050944*u**6*v**3 + 703766528*u**6*v**2 + 296166656*u**6*v + 54696448*u**6 + 40*u**5*v**12 + 3608*u**5*v**11 + 93424*u**5*v**10 + 1253756*u**5*v**9 + 10339680*u**5*v**8 + 55205408*u**5*v**7 + 194301568*u**5*v**6 + 455107008*u**5*v**5 + 711161984*u**5*v**4 + 729060480*u**5*v**3 + 464728320*u**5*v**2 + 165153792*u**5*v + 25831424*u**5 + 120*u**4*v**12 + 5264*u**4*v**11 + 107524*u**4*v**10 + 1324272*u**4*v**9 + 10217976*u**4*v**8 + 50236736*u**4*v**7 + 160271552*u**4*v**6 + 336480256*u**4*v**5 + 465885312*u**4*v**4 + 415349248*u**4*v**3 + 223496192*u**4*v**2 + 64689152*u**4*v + 8306688*u**4 + 64*u**3*v**12 + 3264*u**3*v**11 + 82304*u**3*v**10 + 1062912*u**3*v**9 + 7775360*u**3*v**8 + 34735744*u**3*v**7 + 99073792*u**3*v**6 + 184411136*u**3*v**5 + 223919360*u**3*v**4 + 171063296*u**3*v**3 + 75425792*u**3*v**2 + 16613376*u**3*v + 1630208*u**3 - 16*u**2*v**12 + 1728*u**2*v**11 + 55456*u**2*v**10 + 667968*u**2*v**9 + 4332864*u**2*v**8 + 17062272*u**2*v**7 + 42960000*u**2*v**6 + 70520832*u**2*v**5 + 74790400*u**2*v**4 + 48449536*u**2*v**3 + 16871424*u**2*v**2 + 2445312*u**2*v + 147456*u**2 + 1152*u*v**11 + 26880*u*v**10 + 267584*u*v**9 + 1493632*u*v**8 + 5161600*u*v**7 + 11513344*u*v**6 + 16765952*u*v**5 + 15612928*u*v**4 + 8564736*u*v**3 + 2273280*u*v**2 + 147456*u*v + 256*v**11 + 5184*v**10 + 45568*v**9 + 227200*v**8 + 706304*v**7 + 1421824*v**6 + 1865728*v**5 + 1548288*v**4 + 729088*v**3 + 147456*v**2
    s2 = sqrt(2)
    print('g =', factor(g.subs(v, (2/u - u)/(1 + t)).subs(u, s2/(1 + s))))
    # f(acb)'s numerator
    h = 3008*u**18 + 27072*u**17*v + 38656*u**17 + 110544*u**16*v**2 + 325504*u**16*v + 224896*u**16 + 270720*u**15*v**3 + 1231488*u**15*v**2 + 1741312*u**15*v + 797696*u**15 + 442740*u**14*v**4 + 2760640*u**14*v**3 + 5976768*u**14*v**2 + 5510912*u**14*v + 2052480*u**14 + 509292*u**13*v**5 + 4069680*u**13*v**4 + 11938368*u**13*v**3 + 16487168*u**13*v**2 + 12123904*u**13*v + 4687104*u**13 + 422483*u**12*v**6 + 4136344*u**12*v**5 + 15292136*u**12*v**4 + 27677824*u**12*v**3 + 29468496*u**12*v**2 + 23467264*u**12*v + 11142400*u**12 + 254646*u**11*v**7 + 2951056*u**11*v**6 + 13008656*u**11*v**5 + 27948352*u**11*v**4 + 36053248*u**11*v**3 + 44835264*u**11*v**2 + 51667072*u**11*v + 26019584*u**11 + 110685*u**10*v**8 + 1472192*u**10*v**7 + 7304432*u**10*v**6 + 16308272*u**10*v**5 + 18507836*u**10*v**4 + 33422400*u**10*v**3 + 93494240*u**10*v**2 + 119504128*u**10*v + 51476160*u**10 + 33840*u**9*v**9 + 499320*u**9*v**8 + 2543960*u**9*v**7 + 3796368*u**9*v**6 - 7082020*u**9*v**5 - 11606176*u**9*v**4 + 76041920*u**9*v**3 + 230262976*u**9*v**2 + 230830400*u**9*v + 79669248*u**9 + 6909*u**8*v**10 + 107480*u**8*v**9 + 429408*u**8*v**8 - 1571408*u**8*v**7 - 17276324*u**8*v**6 - 43300944*u**8*v**5 + 12693432*u**8*v**4 + 245354880*u**8*v**3 + 448838976*u**8*v**2 + 337013120*u**8*v + 93912704*u**8 + 846*u**7*v**11 + 12288*u**7*v**10 - 26784*u**7*v**9 - 1550624*u**7*v**8 - 11873016*u**7*v**7 - 37425216*u**7*v**6 - 24950048*u**7*v**5 + 165001408*u**7*v**4 + 505677184*u**7*v**3 + 624308096*u**7*v**2 + 363410304*u**7*v + 83288320*u**7 + 47*u**6*v**12 + 272*u**6*v**11 - 26000*u**6*v**10 - 527344*u**6*v**9 - 4302684*u**6*v**8 - 16698784*u**6*v**7 - 19879696*u**6*v**6 + 80499072*u**6*v**5 + 374456768*u**6*v**4 + 671955200*u**6*v**3 + 618082944*u**6*v**2 + 286851584*u**6*v + 54696448*u**6 - 56*u**5*v**12 - 4040*u**5*v**11 - 86704*u**5*v**10 - 852708*u**5*v**9 - 4075104*u**5*v**8 - 5840288*u**5*v**7 + 32997184*u**5*v**6 + 194757312*u**5*v**5 + 466832640*u**5*v**4 + 606932224*u**5*v**3 + 436783104*u**5*v**2 + 163024896*u**5*v + 25831424*u**5 - 168*u**4*v**12 - 6128*u**4*v**11 - 83516*u**4*v**10 - 495888*u**4*v**9 - 442664*u**4*v**8 + 11201600*u**4*v**7 + 71816512*u**4*v**6 + 216545152*u**4*v**5 + 374773632*u**4*v**4 + 380883712*u**4*v**3 + 218173952*u**4*v**2 + 64467968*u**4*v + 8306688*u**4 - 128*u**3*v**12 - 3136*u**3*v**11 - 21632*u**3*v**10 + 107904*u**3*v**9 + 2589376*u**3*v**8 + 17759360*u**3*v**7 + 65766528*u**3*v**6 + 146770816*u**3*v**5 + 201563648*u**3*v**4 + 165312512*u**3*v**3 + 74983424*u**3*v**2 + 16613376*u**3*v + 1630208*u**3 - 16*u**2*v**12 + 192*u**2*v**11 + 19488*u**2*v**10 + 327744*u**2*v**9 + 2630208*u**2*v**8 + 12160384*u**2*v**7 + 34769408*u**2*v**6 + 62979840*u**2*v**5 + 71486464*u**2*v**4 + 48007168*u**2*v**3 + 16871424*u**2*v**2 + 2445312*u**2*v + 147456*u**2 + 640*u*v**11 + 17408*u*v**10 + 194368*u*v**9 + 1188480*u*v**8 + 4425344*u*v**7 + 10492672*u*v**6 + 16019456*u*v**5 + 15391744*u*v**4 + 8564736*u*v**3 + 2273280*u*v**2 + 147456*u*v + 256*v**11 + 5184*v**10 + 45568*v**9 + 227200*v**8 + 706304*v**7 + 1421824*v**6 + 1865728*v**5 + 1548288*v**4 + 729088*v**3 + 147456*v**2
    print('h =', factor(h.subs(v, (2/u - u)/(1 + t)).subs(u, s2/(1 + s))))

if __name__ == '__main__':
    main()