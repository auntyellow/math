from sympy import *

# ISBN 9787030207210, p171, ยง7.3.3, ex 9

def main():
    x, y, z = symbols('x, y, z', negative = False)
    f = 8*x**7 + (8*z + 6*y)*x**6 + 2*y*(31*y - 77*z)*x**5 - y*(69*y**2 - 2*z**2 - 202*y*z)*x**4 \
        + 2*y*(9*y**3 + 57*y*z**2 - 85*y**2*z + 9*z**3)*x**3 + 2*y**2*z*(-13*z**2 - 62*y*z + 27*y**2)*x**2 \
        + 2*y**3*z**2*(-11*z + 27*y)*x + y**3*z**3*(z + 18*y)
    u, v = symbols('u, v', negative = False)
    print('f(xyz) =', factor(f.subs(y, x*(1 + u)).subs(z, x*(1 + u + v))))
    print('f(xzy) =', factor(f.subs(z, x*(1 + u)).subs(y, x*(1 + u + v))))
    print('f(yxz) =', factor(f.subs(x, y*(1 + u)).subs(z, y*(1 + u + v))))
    print('f(yzx) =', factor(f.subs(z, y*(1 + u)).subs(x, y*(1 + u + v))))
    print('f(zxy) =', factor(f.subs(x, z*(1 + u)).subs(y, z*(1 + u + v))))
    print('f(zyx) =', factor(f.subs(y, z*(1 + u)).subs(x, z*(1 + u + v))))

    # f(xyz)
    g1 = 19*u**7 + 58*u**6*v + 165*u**6 + 60*u**5*v**2 + 390*u**5*v + 495*u**5 + 22*u**4*v**3 + 288*u**4*v**2 + 808*u**4*v + 645*u**4 + u**3*v**4 + 66*u**3*v**3 + 350*u**3*v**2 + 604*u**3*v + 400*u**3 + 3*u**2*v**4 + 40*u**2*v**3 + 90*u**2*v**2 + 200*u**2*v + 112*u**2 + 3*u*v**4 - 12*u*v**3 - 16*u*v**2 + 64*u*v + v**4 - 8*v**3 + 16*v**2
    # f(yxz)
    g2 = 16*u**7 + 8*u**6*v - 16*u**6 - 48*u**5*v - 80*u**5 + 56*u**4*v**2 - 8*u**4*v + 16*u**4 + 18*u**3*v**3 + 260*u**3*v**2 + 128*u**3*v + 128*u**3 + 28*u**2*v**3 + 260*u**2*v**2 + 48*u**2*v + 64*u**2 - 16*u*v**3 + 72*u*v**2 - 32*u*v + v**4 - 8*v**3 + 16*v**2
    # f(yzx)
    g3 = 16*u**7 + 104*u**6*v - 16*u**6 + 288*u**5*v**2 - 48*u**5*v - 80*u**5 + 440*u**4*v**3 + 56*u**4*v**2 - 392*u**4*v + 16*u**4 + 400*u**3*v**4 + 366*u**3*v**3 - 508*u**3*v**2 - 64*u**3*v + 128*u**3 + 216*u**2*v**5 + 522*u**2*v**4 - 28*u**2*v**2 + 336*u**2*v + 64*u**2 + 64*u*v**6 + 314*u*v**5 + 356*u*v**4 + 216*u*v**3 + 360*u*v**2 + 160*u*v + 8*v**7 + 70*v**6 + 160*v**5 + 165*v**4 + 160*v**3 + 112*v**2
    # f(zxy)
    g4 = 25*u**7 - 5*u**6*v + 115*u**6 - 37*u**5*v**2 - 74*u**5*v + 211*u**5 + 3*u**4*v**3 - 169*u**4*v**2 - 221*u**4*v + 193*u**4 + 18*u**3*v**4 + 58*u**3*v**3 - 240*u**3*v**2 - 272*u**3*v + 88*u**3 + 108*u**2*v**4 + 248*u**2*v**3 - 60*u**2*v**2 - 152*u**2*v + 16*u**2 + 216*u*v**4 + 384*u*v**3 + 112*u*v**2 - 32*u*v + 144*v**4 + 192*v**3 + 64*v**2
    print('g1(uv) =', factor(g1.subs(v, u*(1 + v))))
    print('g1(vu) =', factor(g1.subs(u, v*(1 + u))))
    print('g2(uv) =', factor(g2.subs(v, u*(1 + v))))
    print('g2(vu) =', factor(g2.subs(u, v*(1 + u))))
    print('g3(uv) =', factor(g3.subs(v, u*(1 + v)))) # *
    print('g3(vu) =', factor(g3.subs(u, v*(1 + u))))
    print('g4(uv) =', factor(g4.subs(v, u*(1 + v))))
    print('g4(vu) =', factor(g4.subs(u, v*(1 + u))))
    # g1(uv)
    h1 = u**5*v**4 + 26*u**5*v**3 + 132*u**5*v**2 + 248*u**5*v + 160*u**5 + 3*u**4*v**4 + 78*u**4*v**3 + 504*u**4*v**2 + 1176*u**4*v + 912*u**4 + 3*u**3*v**4 + 52*u**3*v**3 + 488*u**3*v**2 + 1640*u**3*v + 1696*u**3 + u**2*v**4 - 8*u**2*v**3 + 60*u**2*v**2 + 752*u**2*v + 1328*u**2 - 8*u*v**3 - 40*u*v**2 + 144*u*v + 576*u + 16*v**2 + 96*v + 192
    # g2(uv)
    h2 = 8*u**5*v + 24*u**5 + 18*u**4*v**3 + 110*u**4*v**2 + 118*u**4*v + 10*u**4 + 28*u**3*v**3 + 344*u**3*v**2 + 596*u**3*v + 200*u**3 + u**2*v**4 - 12*u**2*v**3 + 218*u**2*v**2 + 604*u**2*v + 389*u**2 - 8*u*v**3 + 48*u*v**2 + 168*u*v + 240*u + 16*v**2 + 48
    # g2(vu)
    h3 = 16*u**7*v**5 + 120*u**6*v**5 - 16*u**6*v**4 + 384*u**5*v**5 - 144*u**5*v**4 - 80*u**5*v**3 + 680*u**4*v**5 - 424*u**4*v**4 - 408*u**4*v**3 + 16*u**4*v**2 + 720*u**3*v**5 - 558*u**3*v**4 - 572*u**3*v**3 + 192*u**3*v**2 + 128*u**3*v + 456*u**2*v**5 - 330*u**2*v**4 - 40*u**2*v**3 + 740*u**2*v**2 + 432*u**2*v + 64*u**2 + 160*u*v**5 - 58*u*v**4 + 404*u*v**3 + 952*u*v**2 + 552*u*v + 96*u + 24*v**5 + 10*v**4 + 200*v**3 + 389*v**2 + 240*v + 48
    # g3(vu)
    h4 = 16*u**7*v**5 + 216*u**6*v**5 - 16*u**6*v**4 + 1248*u**5*v**5 - 144*u**5*v**4 - 80*u**5*v**3 + 4000*u**4*v**5 - 424*u**4*v**4 - 792*u**4*v**3 + 16*u**4*v**2 + 7680*u**3*v**5 - 210*u**3*v**4 - 2876*u**3*v**3 + 128*u**3*v + 8832*u**2*v**5 + 1236*u**2*v**4 - 4676*u**2*v**3 - 124*u**2*v**2 + 720*u**2*v + 64*u**2 + 5632*u*v**5 + 2344*u*v**4 - 3136*u*v**3 + 32*u*v**2 + 1416*u*v + 288*u + 1536*v**5 + 1264*v**4 - 464*v**3 + 305*v**2 + 984*v + 336

    print('h1(uv) =', factor(h1.subs(u, 1/u).subs(v, u*(1 + v))))
    print('h1(vu) =', factor(h1.subs(u, 1/u).subs(u, v*(1 + u))))
    # h1(uv)
    j1 = u**7*v**4 - 4*u**7*v**3 - 2*u**7*v**2 + 12*u**7*v + 9*u**7 + 3*u**6*v**4 + 4*u**6*v**3 - 46*u**6*v**2 + 4*u**6*v + 51*u**6 + 3*u**5*v**4 + 64*u**5*v**3 + 234*u**5*v**2 + 432*u**5*v + 451*u**5 + u**4*v**4 + 82*u**4*v**3 + 728*u**4*v**2 + 1966*u**4*v + 1895*u**4 + 26*u**3*v**3 + 582*u**3*v**2 + 2726*u**3*v + 3498*u**3 + 132*u**2*v**2 + 1440*u**2*v + 3004*u**2 + 248*u*v + 1160*u + 160
    print('j1(v<=3) =', factor(j1.subs(v, 3/(1 + v))))
    print('j1(v>=3) =', factor(j1.subs(v, 3*(1 + v))))
    # j1(v<=3)
    k1 = 9*u**7*v**4 + 72*u**7*v**3 + 144*u**7*v**2 + 51*u**6*v**4 + 216*u**6*v**3 - 72*u**6*v**2 - 480*u**6*v + 451*u**5*v**4 + 3100*u**5*v**3 + 8700*u**5*v**2 + 11632*u**5*v + 5824*u**5 + 1895*u**4*v**4 + 13478*u**4*v**3 + 35616*u**4*v**2 + 40592*u**4*v + 16640*u**4 + 3498*u**3*v**4 + 22170*u**3*v**3 + 50760*u**3*v**2 + 49704*u**3*v + 17616*u**3 + 3004*u**2*v**4 + 16336*u**2*v**3 + 32172*u**2*v**2 + 27352*u**2*v + 8512*u**2 + 1160*u*v**4 + 5384*u*v**3 + 9192*u*v**2 + 6872*u*v + 1904*u + 160*v**4 + 640*v**3 + 960*v**2 + 640*v + 160
    print('k1(uv) =', factor(k1.subs(u, 1/u).subs(v, u*(1 + v)))) # *
    print('k1(vu) =', factor(k1.subs(u, 1/u).subs(u, v*(1 + u))))

    print('h2(uv) =', factor(h2.subs(u, 1/u).subs(v, u*(1 + v))))
    print('h2(vu) =', factor(h2.subs(u, 1/u).subs(u, v*(1 + u))))
    # h2(uv)
    j2 = u**7*v**4 - 4*u**7*v**3 - 2*u**7*v**2 + 12*u**7*v + 9*u**7 - 12*u**6*v**3 + 12*u**6*v**2 + 60*u**6*v + 36*u**6 + 28*u**5*v**3 + 302*u**5*v**2 + 688*u**5*v + 462*u**5 + 18*u**4*v**3 + 398*u**4*v**2 + 1346*u**4*v + 1206*u**4 + 110*u**3*v**2 + 816*u**3*v + 1095*u**3 + 118*u**2*v + 318*u**2 + 8*u*v + 18*u + 24
    print('j2(v<=3) =', factor(j2.subs(v, 3/(1 + v))))
    print('j2(v>=3) =', factor(j2.subs(v, 3*(1 + v))))
    # j2(v>=3)
    k2 = 27*u**7*v**4 + 72*u**7*v**3 + 48*u**7*v**2 - 108*u**6*v**3 - 288*u**6*v**2 - 192*u**6*v + 252*u**5*v**3 + 1662*u**5*v**2 + 3256*u**5*v + 2000*u**5 + 162*u**4*v**3 + 1680*u**4*v**2 + 4220*u**4*v + 3104*u**4 + 330*u**3*v**2 + 1476*u**3*v + 1511*u**3 + 118*u**2*v + 224*u**2 + 8*u*v + 14*u + 8
    print('k2(uv) =', factor(k2.subs(u, 1/u).subs(v, u*(1 + v)))) # *
    print('k2(vu) =', factor(k2.subs(u, 1/u).subs(u, v*(1 + u))))

    print('h3(uv) =', factor(h3.subs(u, 1/u).subs(v, u*(1 + v))))
    print('h3(vu) =', factor(h3.subs(u, 1/u).subs(u, v*(1 + u))))
    # h3(uv)
    j3 = 24*u**7*v**5 + 120*u**7*v**4 + 240*u**7*v**3 + 240*u**7*v**2 + 120*u**7*v + 24*u**7 + 160*u**6*v**5 + 810*u**6*v**4 + 1640*u**6*v**3 + 1660*u**6*v**2 + 840*u**6*v + 170*u**6 + 456*u**5*v**5 + 2222*u**5*v**4 + 4528*u**5*v**3 + 4812*u**5*v**2 + 2648*u**5*v + 598*u**5 + 720*u**4*v**5 + 3270*u**4*v**4 + 6284*u**4*v**3 + 6821*u**4*v**2 + 4270*u**4*v + 1183*u**4 + 680*u**3*v**5 + 2842*u**3*v**4 + 4528*u**3*v**3 + 4284*u**3*v**2 + 3192*u**3*v + 1274*u**3 + 384*u**2*v**5 + 1496*u**2*v**4 + 1572*u**2*v**3 + 320*u**2*v**2 + 540*u**2*v + 728*u**2 + 120*u*v**5 + 456*u*v**4 + 216*u*v**3 - 696*u*v**2 - 384*u*v + 288*u + 16*v**5 + 64*v**4 + 16*v**3 - 160*v**2 - 64*v + 128
    print('j3(v<=1) =', factor(j3.subs(v, 1/(1 + v))))
    print('j3(v>=1) =', factor(j3.subs(v, 1 + v)))
    # j3(v<=1)
    k3 = 24*u**7*v**5 + 240*u**7*v**4 + 960*u**7*v**3 + 1920*u**7*v**2 + 1920*u**7*v + 768*u**7 + 170*u**6*v**5 + 1690*u**6*v**4 + 6720*u**6*v**3 + 13360*u**6*v**2 + 13280*u**6*v + 5280*u**6 + 598*u**5*v**5 + 5638*u**5*v**4 + 21384*u**5*v**3 + 40832*u**5*v**2 + 39296*u**5*v + 15264*u**5 + 1183*u**4*v**5 + 10185*u**4*v**4 + 35731*u**4*v**3 + 64197*u**4*v**2 + 59296*u**4*v + 22548*u**4 + 1274*u**3*v**5 + 9562*u**3*v**4 + 29792*u**3*v**3 + 49272*u**3*v**2 + 43888*u**3*v + 16800*u**3 + 728*u**2*v**5 + 4180*u**2*v**4 + 9760*u**2*v**3 + 13052*u**2*v**2 + 11400*u**2*v + 5040*u**2 + 288*u*v**5 + 1056*u*v**4 + 648*u*v**3 - 1296*u*v**2 - 1296*u*v + 128*v**5 + 576*v**4 + 864*v**3 + 432*v**2
    print('k3(uv) =', factor(k3.subs(v, u*(1 + v)))) # *
    print('k3(vu) =', factor(k3.subs(u, v*(1 + u))))

    print('h4(uv) =', factor(h4.subs(u, 1/u).subs(v, u*(1 + v))))
    print('h4(vu) =', factor(h4.subs(u, 1/u).subs(u, v*(1 + u)))) # *
    # h4(uv)
    j4 = 1536*u**7*v**5 + 7680*u**7*v**4 + 15360*u**7*v**3 + 15360*u**7*v**2 + 7680*u**7*v + 1536*u**7 + 5632*u**6*v**5 + 29424*u**6*v**4 + 61376*u**6*v**3 + 63904*u**6*v**2 + 33216*u**6*v + 6896*u**6 + 8832*u**5*v**5 + 46504*u**5*v**4 + 97232*u**5*v**3 + 100992*u**5*v**2 + 52144*u**5*v + 10712*u**5 + 7680*u**4*v**5 + 39636*u**4*v**4 + 78608*u**4*v**3 + 75113*u**4*v**2 + 34546*u**4*v + 6085*u**4 + 4000*u**3*v**5 + 19790*u**3*v**4 + 34484*u**3*v**3 + 24744*u**3*v**2 + 6180*u**3*v + 130*u**3 + 1248*u**2*v**5 + 5816*u**2*v**4 + 7908*u**2*v**3 + 1184*u**2*v**2 - 2916*u**2*v - 424*u**2 + 216*u*v**5 + 936*u*v**4 + 792*u*v**3 - 1080*u*v**2 - 1152*u*v + 288*u + 16*v**5 + 64*v**4 + 16*v**3 - 160*v**2 - 64*v + 128
    print('j4(v<=1) =', factor(j4.subs(v, 1/(1 + v))))
    print('j4(v>=1) =', factor(j4.subs(v, 1 + v)))
    # j4(v<=1)
    k4 = 1536*u**7*v**5 + 15360*u**7*v**4 + 61440*u**7*v**3 + 122880*u**7*v**2 + 122880*u**7*v + 49152*u**7 + 6896*u**6*v**5 + 67696*u**6*v**4 + 265728*u**6*v**3 + 521344*u**6*v**2 + 511232*u**6*v + 200448*u**6 + 10712*u**5*v**5 + 105704*u**5*v**4 + 416688*u**5*v**3 + 820192*u**5*v**2 + 806080*u**5*v + 316416*u**5 + 6085*u**4*v**5 + 64971*u**4*v**4 + 274147*u**4*v**3 + 572073*u**4*v**2 + 590800*u**4*v + 241668*u**4 + 130*u**3*v**5 + 6830*u**3*v**4 + 50764*u**3*v**3 + 147096*u**3*v**2 + 188360*u**3*v + 89328*u**3 - 424*u**2*v**5 - 5036*u**2*v**4 - 14720*u**2*v**3 - 10276*u**2*v**2 + 11400*u**2*v + 12816*u**2 + 288*u*v**5 + 288*u*v**4 - 2808*u*v**3 - 6480*u*v**2 - 3888*u*v + 128*v**5 + 576*v**4 + 864*v**3 + 432*v**2
    print('k4(uv) =', factor(k4.subs(v, u*(1 + v)))) # *
    print('k4(vu) =', factor(k4.subs(u, v*(1 + u))))
    # * proved by polynomial-prover

if __name__ == '__main__':
    main()