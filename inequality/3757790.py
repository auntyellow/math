from sympy import *

# https://math.stackexchange.com/q/3757790

def cyc(f, vars):
    x, y, z = vars
    t = symbols('t', negative = False)
    return f.subs(z, t).subs(y, z).subs(x, y).subs(t, x)

def sum_cyc(f, vars):
    f1 = cyc(f, vars)
    return f + f1 + cyc(f1, vars)

def main():
    x, y, z = symbols('x, y, z', negative = False)
    f = sum_cyc((y + z)/x, (x, y, z)) + 1728*x**3*y**3*z**3/((x + y)**2*(y + z)**2*(z + x)**2*(x + y + z)**3) - 4*sum_cyc(x/(y + z), (x, y, z)) - 1
    t, u, v, w = symbols('t, u, v, w', negative = False)
    # x <= y <= z
    print('f =', factor(f.subs(y, x*(1 + u)).subs(z, x*(1 + u + v))))
    # f's numerator
    g = 64*u**12 + 384*u**11*v + 896*u**11 + 1008*u**10*v**2 + 4928*u**10*v + 5472*u**10 + 1520*u**9*v**3 + 11712*u**9*v**2 + 27360*u**9*v + 18848*u**9 + 1452*u**8*v**4 + 15744*u**8*v**3 + 58208*u**8*v**2 + 84816*u**8*v + 40548*u**8 + 912*u**7*v**5 + 13144*u**7*v**4 + 68672*u**7*v**3 + 159272*u**7*v**2 + 162192*u**7*v + 57168*u**7 + 377*u**6*v**6 + 7028*u**6*v**5 + 49006*u**6*v**4 + 161644*u**6*v**3 + 263129*u**6*v**2 + 200088*u**6*v + 53720*u**6 + 99*u**5*v**7 + 2384*u**5*v**6 + 21578*u**5*v**5 + 95748*u**5*v**4 + 221715*u**5*v**3 + 270900*u**5*v**2 + 161160*u**5*v + 33328*u**5 + 15*u**4*v**8 + 486*u**4*v**7 + 5689*u**4*v**6 + 33164*u**4*v**5 + 103085*u**4*v**4 + 177030*u**4*v**3 + 171767*u**4*v**2 + 83320*u**4*v + 13092*u**4 + u**3*v**9 + 52*u**3*v**8 + 812*u**3*v**7 + 6276*u**3*v**6 + 25869*u**3*v**5 + 57120*u**3*v**4 + 74934*u**3*v**3 + 63088*u**3*v**2 + 26184*u**3*v + 2944*u**3 + 2*u**2*v**9 + 47*u**2*v**8 + 528*u**2*v**7 + 3150*u**2*v**6 + 8694*u**2*v**5 + 11103*u**2*v**4 + 11312*u**2*v**3 + 11916*u**2*v**2 + 4416*u**2*v + 288*u**2 + 8*u*v**8 + 136*u*v**7 + 720*u*v**6 + 496*u*v**5 - 1816*u*v**4 - 1176*u*v**3 + 1344*u*v**2 + 288*u*v + 4*v**8 + 48*v**7 + 184*v**6 - 16*v**5 - 444*v**4 - 64*v**3 + 288*v**2
    # g = 0 when u = v = 0 or (u = 0 and v = 1)
    print('g(v<=1) =', factor(g.subs(v, 1/(1 + v))))
    print('g(v>=1) =', factor(g.subs(v, 1 + v)))

if __name__ == '__main__':
    main()