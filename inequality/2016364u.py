from sympy import *

# https://math.stackexchange.com/q/2016364

def main():
    a, b, c, d = symbols('a, b, c, d', negative = False)
    f = a**4 + b**4 + c**4 + d**4 + a**2*b**2 + b**2*c**2 + c**2*d**2 + d**2*a**2 + 8*(1 - a)*(1 - b)*(1 - c)*(1 - d) - 1
    '''
    S2 = S(1)/2
    print('f(----) =', factor(f.subs(a, S2/(1 + a)).subs(b, S2/(1 + b)).subs(c, S2/(1 + c)).subs(d, S2/(1 + d))))
    print('f(---+) =', factor(f.subs(a, S2/(1 + a)).subs(b, S2/(1 + b)).subs(c, S2/(1 + c)).subs(d, S2 + S2/(1 + d))))
    print('f(--++) =', factor(f.subs(a, S2/(1 + a)).subs(b, S2/(1 + b)).subs(c, S2 + S2/(1 + c)).subs(d, S2 + S2/(1 + d))))
    print('f(-+++) =', factor(f.subs(a, S2/(1 + a)).subs(b, S2 + S2/(1 + b)).subs(c, S2 + S2/(1 + c)).subs(d, S2 + S2/(1 + d))))
    print('f(++++) =', factor(f.subs(a, S2 + S2/(1 + a)).subs(b, S2 + S2/(1 + b)).subs(c, S2 + S2/(1 + c)).subs(d, S2 + S2/(1 + d))))
    print('f(-+-+) =', factor(f.subs(a, S2/(1 + a)).subs(b, S2 + S2/(1 + b)).subs(c, S2/(1 + c)).subs(d, S2 + S2/(1 + d))))
    '''
    f_a, f_b, f_c, f_d = diff(f, a), diff(f, b), diff(f, c), diff(f, d)
    print('f_a =', f_a)
    print('f_b =', f_b)
    print('f_c =', f_c)
    print('f_d =', f_d)
    # too slow
    # B = groebner([f_a, f_b, f_c, f_d], a, b, c, d)
    # results from 2016364-sage.py
    B = [
        2949437927638879520748136303648217183623693017233571265826534965361470401031867476868752230167433034575194206753660162658938844289141399740516184738587559336506849899108006719252137720021398352883727333444294170966592761072175444583420182825633029782215172297003297344655776684756729433801066900088582540234479070699484698907773461454646397956793291297956213535745894304939654100093832441207624647983315340983188502564000*a + 2949437927638879520748136303648217183623693017233571265826534965361470401031867476868752230167433034575194206753660162658938844289141399740516184738587559336506849899108006719252137720021398352883727333444294170966592761072175444583420182825633029782215172297003297344655776684756729433801066900088582540234479070699484698907773461454646397956793291297956213535745894304939654100093832441207624647983315340983188502564000*c + 893208814592021707897261928493802843295867148837132575264056052689105988802658709498716265858502308434883108786902295114271363467089517916442245055943599324157261058842084126532998783962961037808118566137800611409127832594276280544485716037397534545165299856054980235537776105288359443089011881053139479329442614754464910490817924925188389520999320216430755452960610368482235431040175976538376840450016602032864377180370772372393712*d**45 - 20517524224922113569412013157706754290434523539463812244232531870918337679288681567905951301699550835217492707257371950757164381472750478014521555235401116163374153652825667622433633644361838287830959805498654275178777676237901856208618038557846695716038412703795247102902208390736632083321351841977726220932123749373755563818559380331158955323644080633814458865011442078600127613490106394816213019918347616655058099599640661713102776*d**44 + 232070297589703612787391356148012541625270274487635605421237773017313003897750603938125361127757530884494048296871058958481491754175797931357687557413130284188204259802725216841027980611217975126753098636648633744263173378954851303136053817429865486407624912193040668256147180132600604722163688851885265361015720227074460404574994347297414631298695451945625136292895474643797871857477967382611535558210900523186632066463136533966972732*d**43 - 1717537049212733945613234552185370080750726936537501914591610365199601488016088922271755462234731993992638682341081204587231822737388873423553855569377057963960188994182291054776109532301366496839921681017568511921721877939324075024792929828589218445502438494844255239069756112325144481015234520989776760047755328284095955248806045068993587020883172450514425197873169210241556542189735062285851699686414883917982724856396859288266521922*d**42 + 9371637901171130967350573066495200950017951444470851255086747374930877752708063699620060710519993258334819899718801678498588841744930431881322164411803060631753161566167256402158956073306706670136627494115844741392238845352010094850235351582143991049099209701448136528165430082189898029192736342206746569794853312066513575887812666999732211190135063053711289966692369008055478974706677852557801413819959948104365388280144090168068654862*d**41 - 40440314352966983992761508052090053520210319770138008341413677441874998287104506831394125554161772936681403223326602421094635570780003732280492990909119820620489353695646359715106592741484123521760194923140947516492652842677400357404308124360669160097629966194711808978339620647588512517154154115455037486412163548690730959182755532298189712752780376428325854794558248125337222380298878228038681776342095427494576823279747646682025203902*d**40 + 144962278282788598563057425239266809264745880318961667606929046752643771339002111834953634996616439234947195757936243707266263480272494859987346862037261329991642731908583590036260460355626189763468026281434605116470638329545387139176728098966570141759459699776959079385244711446070924542641994870028527626996990367036338318194746067812375827886501801260018373170585085367788933619901993771304520337262588701282447577568473611075943960642*d**39 - 447981018794740431341102107974189277841110322276765162598177345846691399889999030060317464393093637364433083801226736903368047491062668489769448785808079864874144579292310870323525256607876429033991659810941645859942609434216834971470394909887627079805517522293204951868756667764661318423383974952772960429408789322868926909086206438985407738309108660249823699510501025263199786737899949974811835663939539868596483906468372385831934206052*d**38 + 1226756577171231610299659980270410863990442077772265209113062122396283470762625527759617264525280732180518605739570007073272874312392209244661029388779539034024992117221640054799988734262300417264429816085687080245301367791325731314614815251375013537413045972071098244755993210120575065923974074758552058705025542416106752391090824261494744996576262634562458353963532541899563917259151309912263879220580161510137210599651864762999623904048*d**37 - 3031649093423951194461521445595064954630452173448766210295835880343155008332231948859186314952851061822612569832147013591935999297378727015448459395539752054715145918159064940474103794955636999986625359489739636295437171219807401763274914382801763927886146294830983075284594491784125985143130951152522510169195282504273311511328108029572644777480696623995498475427319513777296831320524355193812779767836053696090312467518053163177969808055*d**36 + 6829519271571132881475773439803377956410812419982035744436713494829431337071622336359515461519104217552393761901718571786761349420052469581196415842333254722595863637535961115515308031421065934038392472929287020413980786811696887739799466568584375429681700492452376848220882081470835322000948440384440141422473856524392098082117714988742085707621259462871649826955839782119778749383868289534339383581655263354449102813244390530079364464819*d**35 - 14083729450744381637306932276244011258343335201838628566443009233776748384120020516412525049587170880481815094419505422168359716274263339599131636654354357716255963396259707097078203447442767932886669027109048724724564407562409877385043350071916969826616410117161388360294464842060734101888950825350546153842334396915034203989547139898742589567462747245153020226425556780979469344513035805027137353723285690447742241350999594834841518928153*d**34 + 26617640939111960334398834618676411185564938935972341331482404289245618624906955342019580291129454847189560582067774669247850859640005061386256186708192842430994186997636936819798235280492876413708314738728009735711792472263679348999486139271554773795974384658415478982271008415190712413327075874234658582544361282631286424544181857503048860613925140605252985449830882808208018240798272128959805405126515591587875103389640182791305772465153*d**33 - 46119567018779758046524438756220730180840800007808016429425583091503717935232851275005299653625104079808585669309864793053132496669706409327257184658980215514871055576387370844664800807345306676219308106106657308228485178445141818094087184454610940277892616808714067266356752028350335253936425077836378829763408599116630526609611932544520061639439546472631545597681948319554040971146787852634081010474894322450086380944863304159430559601174*d**32 + 73303903979822266384173915463121889072503303455309365956253550150272060044725711290386011948107421290854984925825453928652260033379965286684238230219126817203163153681942291914098356263514028677374329745104678659105617029466232371829654479654049591414046721405138155530146405437961205492696779912395023397055142884600826706923938859825004683150857649674871361291280075981655343248150015644058371786642266693428871206936220420927577581603551*d**31 - 107008331390513330667547616840227242681542494137055853855462953570930464141477530773122094473275711914331560157058514586212541402304821261718323993917530247071995334380477814169520191399332316502686253157257640585237417236425137102031410240046283426205876754589801801583538137430872865593404792274787739556952875418401646955264073322907737539669591553460757177245418868579091723712961603667767024044802399642875106484151708620147522022420192*d**30 + 143713645055440843894726555564995274799697458352378969865408558768221094430200090726927302715961418270192820864253665394519770575738993992666298033412965345098059898343059520220633934432766650074040171915012946567679915927547124126922286381023862481059034873424539058848877661736650545314154434546254846344110215392863525223757377626252266812099533819826020780948863120679112837084689911825293510066108326673181709350822324166040194504951204*d**29 - 177924341264846627362411918688897131912923625324261736933795430287712906745795054265177393732839528030468393185350766116198277523900483041192411970313264686794097184011448192036029837863356855114785996754673887498399356061343071162095160261055057802699512459031510304774717664864051303663883334396676928506417719496922094918199707125785703911568473261491136405455938269661597213021742244035187679546317700984058913843932839978295517494308530*d**28 + 203486521379936316354000130266098689257255323924854723115233717495941025270529679995876594386322095653355900745403985841057892708208780275239946324484651899597161575335894671806160476262405031980603129969996138923650193572521717490249627307699681961658224946075002264453017482519513683748734025537808403197750347737568586359646424172382147510682831566292979444957329463343055350037150538773050918167639125798838642252055069491317098103212344*d**27 - 215417526319170638694473783604574172092357876186022629590873458285015177926082338045668800033586111440431612586085031308847407117025579061215305869386000574574650049499875619339617190768589689761289742875528709647637970875062994148321247326669653200696808933679347357792212520408445826764600557782271765101528684765036968043990624129757051468625834080728670062864903963806425149288026069308996913373482124651469631681590106288717615252806638*d**26 + 211490620890699759313143658768500130350532862275209427488906074265212434136403880344738916018998326575162931214930153205799157998231991748425142699172729896454620995688774865661521683307759172031491889155220637562148346742261352221159062827866693291989490682883310507266815299409582351214894744026520798221289999115340552959318163177199596413105329536486259667809814266630190467595905850671800248580544236234613024669434288015736883542093965*d**25 - 192886579861455109098607913702543895255315727001214361793109540163118618038267099300737521765562388555676125212667013595965692896333396663314218136731045016736130602452720045686415150423322982631078696465858482838017856987546097260003829626641373019377087748850665454124038430418251500401085155625950744931401592702977019624900041331933914375261639469240239214820071961208852037616912481305497187873438750559091195641738984793206940636185738*d**24 + 163665072420320859361500808302942333353647559867935355321592505117431405052158790983545135481277524696309982966134758105793518099843671771743405336116099699967819941049464974476655102159937804844187268748608089823188808710219868184088107537818821205803912436339487767907143904241248762408402807864038905012053966061507368016794380036440710401852805488472246503178154542008606552562406724724916443766843710519062148981415880420831834724330468*d**23 - 129358243313064915926349356816745000011978214473524587484400254803365836808147552863610372235450719048648935294315768053728867241285325699675411150882696282850851696913659133426998687582628598134107402589097708272455281103803893212209063623306767044362179434449453000215627568568144515315354774953586388878320205257896454593703269877128833533000364633168337975994953876490342065818688698514004707037834543335907313787259465752095325783278263*d**22 + 95333543823999437027509267853080670208212640484311792060770280605320146034638056195130372029531790166896359636629549905964350943413445682009945536430627424505669736328563001394398766528190908509693735009446365445893268341188564725028101559568639639375223573618653048878677185901810012283899978317216723106578869899781614955794666110657449646987169769744283411053126522465071294483883732722916724881406559024300799475154213330728296972822400*d**21 - 65555930596496010814498211321459591883099946393382472055501092485128069363011715000812727025075273711625942026321750293174930049954878050936440418505305698828538662264502072629379906292314592117883931346244179912830828097266072134101954694672766770671331891662750661195712878818470975460409354118862708348918403422652620978433027144861082244164338072956611323624480631604857228762164583479236495908807885317148045138740264019507147332718635*d**20 + 42076708853427187524767879638276065436839318037731555613165160122356848026637189375512385319117475738587326188086968214662534750998779049980588278869559878797761654340461893117700671951853281448555676040736441683733796699078840199793555256829555019057207122519475809946387551399576703610993906723672777131727666062885330907121953893101700826451303611454555277856766088197630971931904552089272965329747739042928540986021580560902510747460770*d**19 - 25205918292752154036197195385994010410790265094398157690244658783974493519040011763825112094003661008785202986549962652175606597570523617377232368768636888703899498713514336222781268697340182172370727606018206440941801086550115595468548892524117036385264774126441174525374530274711927328082995658415097295426780130761119746313445346205772469564734406829270536499648259755445136073677052778501515532985016497788045195085509170717817041219806*d**18 + 14084760028178617569598995444074517975450822515523020556792133064504646338545080327403961329219916376283247276479362536169063779881569322437116598576248520988817029023289278625654057441611813431612333003106300623026257170309514590024410465336298600223754020970389224574005819786386769507956391043979854932902247063781854112917817845489537633557220323472899160763891775067185666164530829198640974328813704294939156494023375139173626290745120*d**17 - 7333253941445098585343940905255154816429505806282501256789649412973301095393362417865764992063952836386741475998048768755805219444968640976320878032917929274309282403462764288359130495176942669815532179558644085586597781116530137310410642508245775538533027630632842215131698693779084546057648141356619800016310869308880255373594930148122377844885706879020819661266912306245601815315639037598296227828822716749836413205505729930570199963014*d**16 + 3551317793354449764717354474826747633351418632468566923125475010545947429849731404290439881576988120159701739839763099360667152607707974711559179419835141418400957368966756466918141557465493898383910712377770882367372912529296206480315172893521014235560494937607127316959111746217379585491815023032009637193971441193420479993549970186561375272792891456067300118587849166111766927854458078419609855756783184371567451747124362013342465653888*d**15 - 1595757753599265264383785593338760652886209455989348410109036633133843106348836200700857452984714767879483392900021078291813921957220362041317372925098403047362673789740428456347839726014307261996039623109183300038390284156516801963730617301943776526073634927347225401177542685481144323921195880465940763990720263573498591025019887284122190577897430912909635001054395112906496222648006255091013505578024503173544985660806497021458775810954*d**14 + 663134580222798206249706417864982180849589749862315121646569183008142149152682723089310607440138207710550137414780136727160395400666206109284427153167322900015749836142285342735234744389053287111839130073729997950864118081487680299354035047437367806019330269715906926312741263514459105565397770466530203698444722219545191732129162285069766967470322624799366140832475369121394406649861830787659479623640257704739882339160884554977716215934*d**13 - 253751825330482639193338003278015843793156323207499913298459939139197334860573125091103225382658243414146918126031071166867748478491273074812741805452433373411128568914546438172507670636703409448427439086609146047978610888323369929179771615812384430164407163981773821492376655046463567714457590125045220082811801795326059876009899721715497196121983038802440073578099859095451163392882620723561530536289746749117984775824539853618749853524*d**12 + 88905153045607151634481229014056481638314322630501146784239885169642890652843057773811304854980899746144638413183181483500643468139125861643576804501063139185593378678171145581823129419971369340205886357954529133820522447147282651465690357904327085563371251853265461892343903544059329625837064951146670143282971103246652915120314999031962210956341910765464587046359879119804526265862645286780861726550917187994690867856462199179628449664*d**11 - 28310727831327483651327063925275516282580846078718224583274790953476952732430675940475007354862082824916833181575055894923038464582196297755944391558332887398522936180123786571932272483706228358900422849198095099029525643107947433526769178319293726291758189716960171782106839764855451510686407330044630326353904983002984439901908275167376141631569173617908509609172514276059067295117055641854432532800043469085954945279014136919641001014*d**10 + 8114836785087273555416930979835169526158827855527351079464647728029033174430675888772074463114151068320202735948886513550925348663671069123147366956793765575193675424033333481373134492024246220904417241024750074288340554776624295678222151387754851356571950250610235735582403498592056076283552207030904812555128318490642263153089917992165231450382228420661620556661187731808349832456905791146175419599465556417720693014737286551087238924*d**9 - 2066748100610929622350398934786213503219881254340023195585818131083160833620409382274629433726703943553493496395242563565206718824949765993298128099537410326218179229312801855621688997838033772957595552131558323739177050956867665690760043566078770440394025566066706638247383238792439034843931495608042954214919115530644820410097161099738241596157020192040597372933825229352618676123778875763117324170620833029072319838182367122781961458*d**8 + 459502929739234712882207532353521568722000049825299606692802515995742831377376587837430519516563310873587311086237998585238726917356942959653081844508601495051316797942110637467911151866216423945040198592171539110807220859546405851148434139145579316477964076537356813983390578168576600283307712340785560218189864280987030205154834306208095348213989673957163476359529412685709231674083745427611833212719699617214429085327855392390387212*d**7 - 87043236322640965972853786446097291938467955027176988859880029255338408160901485296594191132641667040887041307221539802722404317796376417750332654461809486105421374775449985707507835109273840739777734719009347565646772160969647085923357954672443291699176225420237783357578488140257216340553819102280755179637199326437780627341900579034661456475579928927459013919382232583869424830278069801759808647111976934066682079983076582607394908*d**6 + 13593290487473584832028625296104967484173940885365302593592081993701362412292376178462340675295398843641206900060628670442872535523530124799342725361987960339442771081924872914698442580262237034071074661829337240377459204961852044379514104207601621691405803620270970051297123602805022421381478890841951373088676415633999105093848832568823335193278369141240590537350454697593415497998712265288344744433975197676203507298467032557126216*d**5 - 1674612014549628765647954068122326868556187552004946840033211853570481910220639122971830718159856943317776266414214325846575011379116930858063235501832018462661319427738518891428395155291658739151023686239394376689537648759591919075343137595535859894432078127864769668384237593151985528048064529245554085481997796937112926858676137618906481207837883010494287761639135424236233718485768645800170718277860454156974446675704517352030688*d**4 + 153385117215098265002460965041869823081195320620987276422791071061508353577267654341285020142592496605645116610014955441867001650882640721317273519782199068527184661887850377388674742635355671675817034077755155407895411880381411501992734482218022036051000512122115636143959549734793594329489866317825001992907932852670896962727582213608855434548926010663254679343250583176994734452285254511633557102642428926304979221503800443800424*d**3 - 9616781693299679615511670335426261968969724189265657833764039986950570985826573611781639886725628212387862256591277996056510366201443330855622144691229861840640752679812279950875444034666009057805562713233679626241700434920205729760722417061554225180688664773600514625699610598917587060113357795725061711543830254838528031700865966624383293555900191856165891323924827598097503995193307478021395905964536032984429078181859951234712*d**2 + 362845748201348763275940043345708252612535005508878237229716454303288238345936961900971045391841432127734514353257665539669817886744724545770551520089490801385840879988352352700055068989299379904013450028792844263779777344097821533123810860309354832633110642821057330960636381278025949571819707322063785458575309198703309647733670494299850796427372538966215783211097802658485941465665982878855493782302465888842650825616851684976*d - 6216088962511457947035803179507267001488127619643784386721527505336017214280231863122139381565137163664354231365066055963471980817656187506822716845786373192205873852623026021171106227328734567768039559595204384778041544775734741973584463547078142899405184561160011487047168714718618138821611169410159076586553126926135988348977102068899815517311226129599338098316550690898634159723113663097607827824015326874826666052985213120, # B[2]
        -928356265597144020209011320299278274200983757726027987053341615771868728286319483900693935691955894590069242071971536720214668372539338212972537420729801590201622110613979682959784591229148987939026842656693603066027617523680486806912014756306159741749234473507878553097119033083780683150135839357051933310702784943039510902114367619461026897125560840347761998729047340585159733756036600*b + 1376825432938148101054049643128090543296865202860499166433620678575462336606172808501469492170898731526423898168138224833248546015685816044848000923916428104546291128129776778156858956839396434550916132874129797958740240550781517634125819832846738845958501396150500674092127726625462424013390261168456951223935081875557345444639088470089906477873101813382353588592216510527492733608171304612477059936*d**44 - 31558915716656929725606164014000431776630991866631848524737330204072803441642939429790874764211253676690186653851824413610049009951071348256336464148925223411386242265895272379366319917323740487005110798317812432373237049210300842311331631006606701403375653387611545244401351628595363941781962720465503706146412666620338400514807029727760423070599962188905502991864965610195166150707396341879252392256*d**43 + 355260766228895744081300924143241568063897621876910271301374891565312799671322787295856243632257364853533563449130129195336767237640347029862821192010186203583262269209828768615057242326733455659890258558709857558818906002018444649990656284151546546457201781432882219779936457650104721311651943482358092303644806469954939604442913831572103710842157746455585947865887827475786637744285300087666588760864*d**42 - 2608480601458823302931108416737452884623266083967019188255008471935887291027040779734533673722544244503752426480978242145999653782820597144325684471501326123613631563331695206930421342723436575293340288656334580757310146442656690939888077321501261082008084108373521868416644937834114547838020016689747923905919330830787561304301733060879963092717531097411882400972927742264907750676370735760442764853688*d**41 + 14068590370908980873710109823952365769026165870308665311859986580131247982250967168066041441093621172726433936791381049304457862415512650251854675540185049026056135467593749779392470543049263282866615609603105809673301793542138263810562332081757856669934218321576586813179475690826404296888626230049707910805427366202702027747500733440216582054020164096376508772940586001870762438740689479983380469118330*d**40 - 59773619029444012995260360445041927340715136721361844312703084925864345255947594341767416957463163258537049396229501697163686954780109440266988864223023248146411992478245726379640804978961444394913674610782250109959822154714081662775421239441846781944735708307538773231227716689785396811039764555957232746288294691741987829644210460630998399169508966721956276888584892727820550647738816968816553120413366*d**39 + 210219070978919130761887329354746735146296548787327722700915131713538135797647913117035568557008510103484644465441822920249151081638189958999385756425303572931464429604754652305519316791527948093788871718194677155148511514286855000752111698006304147695439570205170814174383545864690249519646672902629609047824502363681003645428156282079748818005717543796639162759006953045300283264762096562828395315362474*d**38 - 635751849203624201558077893583191972382655259117280963305054968949823597107337381828029778417975909732102703059994053187104836734162425160095591765717566188680439065302182346686655292602195370797287337791587193363061581674123599239103253897668203660406852471971164424464540013328132085127668806686086839241760921519173360459339200188113918965215946542481261453050160941789319572340331877594668049784800358*d**37 + 1701390115212591874363661015977748190618638799017070063935728204661579035642959657541317860673157596444825839139640601599888628517002277419812033293345197050002540486125581481007383024287447673588776658895371422756229183419794556431078790548390499374777947458172487085025153346699704535342688049316558157426281503309166938165893364743302854635960527200457003606693673025948690525176522623828982349700466248*d**36 - 4106053220413318027163759672285553468743403609321429566589801175317600128584874605342686507968714103013385654829943306396852941121714198402203594631614307588858825129006904171576343342795436416517516673520500587514883579642707155689299386030018713525683448085653248399563470484213584800865440128554041671461785791924342449605212835728958996328740218193784670308688711700948377339336604871377473873350843114*d**35 + 9022463515308715496189592719010134307103591920391199185301837562402162778410606675290182425791300748848650087700488662711584209211420814473436444803125886985112669485620343845162329749170649166033509376769403786516640482052835040981108720859725282059268601374884863735032972250414867490201769721242546135333493665044237159209220157989473270798680410671115970530182844093829777653105427087595714264808092899*d**34 - 18103072684734464152065698127079024153319870784456986529495719869103581211293175052835361733030955178186959198856530925592367406042036966648199284493909630702159267947672637691807704998543553936494504013556049719871793473831339936314828452617210167855200498596731403671634861008660720483531082260348906936004712099577722937467142347638328326790312011108110716306948820020548012505663942127571263788670930311*d**33 + 33154929875901589528965664230615630834329410519273103061933653756441896902165082092450414950890211414944485132800929931701571479445528086146931120755176172557190618125372105088280944449579653364411421713058980026933528271807007878381394694868243788710053237875580102142132454733002327636439326625780372503441713963982455156519288664494316376904038966422762024224272769864571556041981320963168950072257343907*d**32 - 55380944549628467969616621077803673095402231140818362266243036040221553460205259714108834039039308622026520274500861047748812280930824271065253317636320277501255648595570347507957765104566935814212504905332649942162057240569617274976871302230419892159759621354275898527748063882091971333462083892053791115167323031791173191835349516960370971022772514582145413281747638546124830439952154203193983079662044243*d**31 + 84377891045670709494509992151681189373982984258706570320873410477380246903444947007522189710515835055880170382177110238000945578796279770499958054221310876159600543451021390829056167679465071279815428402511819279151210276994931630472173125894669617517116033420798494308838238492746319130871757025890054580293709993095937255469570282245840742666436273218571474843698295055274308756398558052579907778146529542*d**30 - 117403566652013830439561956538548156095801733206276274043667426110951852888970580998858951486526583019242597793930507816919195464447742210409470156524672685059253074893693099109391598211795607829781376161993377003424563745251624667902590439512717982415806871028975621137246117890732839968895941243934892317447815396220967132001209306819119249741898411968774882146144892861829708926085458988559377738533921107*d**29 + 149486838526846365417196234347280555712007563432280663556670728755288814549660388916880134517514156546193744918637998503897949253348886169587849699204713239908387961648589220855862491115023010555185471019887034109204542526499496671139794124033745978994960356767221772081782284577722475842988038622809867893481406946401801662235900231666901266313227164254601604711653498436543629861244355818853268361753274918*d**28 - 174606091897016941174301401058788104439556853435684368849443068764300193926407036519509774514916788619167914235343254488605233607019374463430019452592549371938673945747260828876772194269612299176805773905621028721177855389418698363947988938655263311027261352614748659045979669044903820490604970946273063315287945343217587868047187916241230613498875780538607353677969328583784314236334342813047367469854568094*d**27 + 187568714622182977850300205138829363309409378946377178029264942974782573395350797105885003305614687691696916069169237362724909219720700508288705147289913073229733491217321905510684668439501218803215810746565307226369979529440130944775344280092729115284193634411214101663285344911981622522521846592122383273012745388614861272407863508988469665155505862217912013215891243812594688415904189439019524913498405744*d**26 - 185770620193734675495608616214282708660833204227440350162171245882747133260308385857849628375485190985411699277395938415637627881063907316768575962646011201941421002824581966569127247782991299985494773856837181464376073554938772264998082207680222325855379098272546350115779688788508382120612852840437252613152996544318013117819442302734061614365331540230469385989513831749145451634485864394385776864359381846*d**25 + 170019856564379976001079050364146545930238018363696398964307906190908218360663347132822806173898399347184081120466434878144958136369203900914067425443261142618940607540297712798424471089554257551128193524296659099565809870445647776240833270832810191647530462960631913350910723692987377152769618250497620653535263252400611143638360419757366459441213013914216557349370438585128324192540095947930391758038825928*d**24 - 144084618027533213273154839032157190281352174371728825973213457847408808234391378761247585678143251060596046532278670936983072554299730117840797083539229105056496777814343272783940257077812249198915028177432291841180232667975990672507440341398258480610102064170224593385467542460729645674607803119184740580327838628752567946479975081439917054435669147025006409928630681569438635028372721657702813652171849713*d**23 + 113267348006092193538806122282491981122350158975097530829475568683741789550467535209256733669138015415997618402033578324078267453681645607509740961338407144227233056143153163572760212905269039686424088654111285500109185130279309004077592940698798290643353355714439450937915779008071672068273810886322963732764407763397554797515825755709558676748276806533167407353417016625073225455490655643338081259975386038*d**22 - 82718035478894741374547571694263459343183982820870336721298609761910018778856745059589747577439278611777762582179904646758227635377934242875334419421001003856760393256445744802625765001614042990965645640547441199790115347655050473209029486878233134342499922740160242193155694393869112893306255704831796090575160979683963814939251118774194202621679941374276685200367696538403104459638679680156887884395164618*d**21 + 56179926138013727912386395333805288968054528440448848409400579589287843111195340803454639627334566733536811029374203894985946222499359842665066580934719882184007084899372026072255380265314900460955207013890867218429655199401090967987131528840782480340066653267468705571298088163785229490982368189021130691666256489590190754308123325225426223822362792564975001566324482417815494129749217505277299670467214999*d**20 - 35508166593995410267709159715152355777632690287000850289165433440108490884850428521982195536809625080606019447343916049281347065622674316012749867615128676698692421942467602498883510305906613756428219853511384235330435137906915518047676158209876031780828603110134396064341665011181410034230226658546268402826245910401992076850573292730915051429319575210187532764636012456740374983789348067515191721792939962*d**19 + 20887756159182374710780156725235798893411365886962277884605603684752528358210339670493523544455166479468447534986005148429761050432975840489132328897253140299098142707762441021518722357362325740454398988480903025217808974056124392328658095319331194189370804595651967541254105910740233429588427247949684401676312753344593922599411724054846146683728395897081750819624131669358680016247480200446312715852214951*d**18 - 11430514316119593997423499345141362607006977778083506712356575908483318663715795256763827487186797144796358381825636825805643716505177093723674301033203464960912588877930423918417660612080028848842275786612355245474034375117766000282984811575866012430332707109974911830915725831520661686997039455987202553778889932887861938058694797094175416343724191966709750087818814067264979846771424571109522903905922436*d**17 + 5812583538514460638192524874975207608446901691725673526243123929238085942633391516423705035546685066201294250237766195427613591894181562446676157741509642173715986512059761019203567090063066892598770176002935609656787670915637745933371078557063451264229712562002508938485582876859538371577441629491935843812432335337609243459796694929768943286682073038910714786726570325469681444757708046982256033266660698*d**16 - 2741717864412318408731410239832604267981182954322739059267367338195038275960208985712269240676170453488988376760831871961444057805986182270610452640640653860595628495902835817666818748962483778698268435454230690477677417231829644487395403436268018696135443177732442080411413541735840626038682210042094594798451212535425245020669395062145167763878163781456864011369363079803166563883172744992309915257999166*d**15 + 1196478716491255173127536312485745296225975602217509201996924975663893282708018431057433660798265205554643039307814550932087026822709841141523265129815210287442102832374614747630755017243815906840822990332857113605985183017200516963344972500769388137060729495576170876183184327578896661453985356341787046329431929083742622723622944689438792910309402591858124617095459334017034178454173683273983271552747402*d**14 - 481373281681951476272177850537427511051213019655780542081106975519201088267782216575379295306294701797537944708847188903148958919905969913311058108515238942553369746303814538857106526052731370642181786797020673814086804172915587767747946630501107430515801496804505656145345232020046112919887481679484103779642354336192149918596996287965229604994754776661332682539506687169947485481441020479386721087102668*d**13 + 177711254546463985001348478857977136848548749594625624620545635573924640575070037213646797124079167093046851176015052598179357629529111761038793499371607076237142483077695802774626410385794959884302640389769430620901073962769101661595190592369178502027297964806908081401354484820079820182685938525053137048017664887473221477386139954210387342173124087534141780018656694857099747241789697158939503722436066*d**12 - 59832875877816187892123979749243882924174017434487754507383004767794827532535519083893936511568721420364162793360959386089464851469586353096297065452678435066180284118455638445393312732278152440424931742038043752209281929741642005402800767464088580493241790974844615719773973187591324079788576169332785971604326702061098511960711701840951657210471641343477171866780977667328166311699403742597584513504730*d**11 + 18225696222496983389566780052409531068813439766267761263886217030413395411107608665817370291856994131157725562930242875494709917469269625743981437350241676167533559929568987356887387391430263375112553657126115419292210281465213987479455617953109031954263177293195764729980281863719622183285340593666578497298904144911711727572230548932182296238173444457884534159489182953689275066230714618738616643074572*d**10 - 4970100908264720111597700669674321536018909844232315753603785915109802982480661452814331537591084078896699387390389898380192569361553636811152711241612226595873247650032184004820729141829358479387359652849711889151967069454566062205254052057235472832498993562704676747563159719724558309483816612686745121419987587285639084493313249002530358004717130376008948588862424617798887734542013208670981720229408*d**9 + 1196330315250130134594342968922545133428107647511108196902915293571867535013311506664490827566955133633112753681985830573072542995859637101965252762154660558669469738501524448844250734311786402693997076523942708624274493224825786099289101123519707740687427348081697243825342411984296918751606497926856257016905764791907628886400049543863861917497358021493518549086955821863902037569171044044223343513206*d**8 - 249419693331533562839878893639069746840813774963276940243454353327414202361148755713538686553779766418780895915033655254497661911481708455824446254501792830362923339269544959637772737761258752088177771107100508898295452511692982000257650075381891460230833478428012882314210837438664972129914935599873283742645298819707957134273813638454522733409835960478010348530425843337782443743613085351535366569152*d**7 + 43930884294375122610901422018414756450565893534630053329395117107742646604060248588918761987083241875401675147272361677105561915889057822196226441447800090530840112249891092212073594226597388949484413231483651848171709875261182416613143132659778825047852296980966169999284158652118176432605211349046326095696597518650954398782028869349381330112688130111242479511670091081199828511094578292394573168722*d**6 - 6328955559498069960464245274096740211580601683547699487382778009833055789074061529599509701573174885012689115150741457287899910291176543950420795308005901951862394443792320288591375977467635048093966313240641200039779840156448864786991619558976645742133643421504285712839140235390577358133366907547964512720494608787751830197056936012375120351429498022429506448564657689667250603496068608071494780600*d**5 + 715359842493950602830516104077594014730316108669456190188247815994288351707991708448590578976589596742279654495409634889917523471845473680679236281428352170441274297196252188736878313256896794631097845188124083852221743260358470309910482943841039146205293563523938967182645141405645208730452793344884734629022992910163587644953789687931062997773938125822745225643482536334507043938392979620836055788*d**4 - 60048798023840782081867418416916681259763593394342489378407192767356578507664611153403209684610834806561612476588931101140261111407837012694952552454626998000399898574640250198749477405038655659569729530617200581056782126874513343448624724610744727003290756596424478993036063671131213431143925821188466171899435552630712914717619829596439052701643499024498823878271779797160137268046877336582157548*d**3 + 3465614218735421036024141360054206260345227263610033981830896491844824551354206043324078335489645512671601248544694665570432418118598166009896783703447646496407444278955832268438094255551854605750426035422259720178610647486156159760287158816884472027814916418021129418403569306405428774486531054740141149934141264538530786428220269427683852625597512665759453789069708831900009942240563891523626256*d**2 - 121395978344946472512501229867372496945597675146681617329237001949071369648988787116495040217033743567235599975086160823527403586494058069314982892727566678901211395314200018266787068751057113348710081176582643783278312569284878177102675907140786746636438004551002993523311045322632541228022075038301205431793652470087363373593249306059253676622542075940575983220095313664922604557772194358018984*d + 1945925934252717486252010637689728336109162244119250772042763505930801400700548702501402599297746070968317886360218727558019947731927055455285066620585051055905787097801290902682088982139376606397136567739280522892209369121748026941994447766552148589728474501581652393355338889337604614596337708005671947251865035550090529172790552274614189308667633598342382059482967529908402239545220947084480, # B[5]
        2945311378592657456220144604933500421478586780019386619269522008558657766910500*c + 3101119005428119199988038116881883959223383590983168537786038499975275572242506491232*d**20 - 16616409864661812399288993169549460792738349687569640730852556541621836003990077698744*d**19 + 48432251133354486602282056702716631502733761531515348043787306140073912242458813974588*d**18 - 118862100727572478067459799760359471736928573219400276766246113245480699565858264970902*d**17 + 280964920698102787965698500407781940258037829414461518009812120590700452522378119307795*d**16 - 598494219310860338865395602464466730289578415153383309509301585808071819893629101995257*d**15 + 1084105547198532571403596858840297685432668471599254720684777587226249713821759583270387*d**14 - 1643600933942658595952587152002063698013239086930656942324116772074999805454165688366428*d**13 + 2085565406651597296723481394135058259032083443065023278950641824968298016885739756637109*d**12 - 2225085234958508946599374813663051158837314610857887627297563040113385484275345477875345*d**11 + 2001881633534393594957460004808821222041428657436296480252783180625439661718284599026302*d**10 - 1520374979457145710618228792647905580432348317224462946143409752764207264358880655496825*d**9 + 974592013210370533418868603679367273275533252410974814749909747936693193175257005210910*d**8 - 524833682442899909872401009870404246157174072663434224350174051637975035873174684109071*d**7 + 235901080595808857455516987074598094306317340598161283254221286980089727322813172462543*d**6 - 88310579287974672545805657531907628083582582927581134035382184351127390819972981205118*d**5 + 26991226769558934891307720172675916240780560233675279862038184338698441030943757980342*d**4 - 6182834057900171343334743872596050178200256062012584064308129344205389166817062261640*d**3 + 895997138056658106705913717118045233554404403611650121770076176445871827922154455072*d**2 - 63787219479721895713761097831267988907144122186086683044541009444405014078813900784*d + 1820319777117733560108411641800817543745375134642227764901544411499188019410651004, # B[7]
        (d - 1)*(2*d - 1)**3*(d**2 + 1)*(d**2 - d + 1)*(6*d**6 - 36*d**5 + 100*d**4 - 92*d**3 + 32*d**2 - 16*d + 9)*(243*d**7 - 1404*d**6 + 3519*d**5 - 4633*d**4 + 3353*d**3 - 1308*d**2 + 248*d - 16)*(531441*d**12 - 2834352*d**11 + 6928416*d**10 - 10786284*d**9 + 12885804*d**8 - 12958704*d**7 + 10799190*d**6 - 7210332*d**5 + 4007584*d**4 - 1997172*d**3 + 856272*d**2 - 260528*d + 39710)*(59049*d**14 - 196830*d**13 + 329508*d**12 - 753300*d**11 + 1938519*d**10 - 3324330*d**9 + 3932675*d**8 - 3583448*d**7 + 2511045*d**6 - 1299104*d**5 + 537554*d**4 - 191304*d**3 + 44136*d**2 - 3972*d + 132), # B[8]
    ]
    d01 = nsolve(B[3], (.95, 1.05), solver='bisect', verify=False)
    d02 = nsolve(B[3], (.7, .95), solver='bisect', verify=False)
    d03 = nsolve(B[3], (.48, .7), solver='bisect', verify=False)
    d04 = nsolve(B[3], (.3, .48), solver='bisect', verify=False)
    d05 = nsolve(B[3], (0, .3), solver='bisect', verify=False)
    d0n = [d01, d02, d03, d04, d05]
    # TODO d05 should have 2 c0
    print('d =', d0n)
    for i in range(0, len(d0n)):
        d0n[i] = nsimplify(d0n[i], tolerance = 1e-20)
    for d0 in d0n:
        p = Poly(B[2].subs({d: d0}), c)
        print(N(p.expr), '= 0')
        c0 = -p.nth(0)/p.nth(1)
        if c0 < 0 or c0 > 1:
            continue
        p = Poly(B[1].subs({c: c0, d: d0}), b)
        print(N(p.expr), '= 0')
        b0 = -p.nth(0)/p.nth(1)
        if b0 < 0 or b0 > 1:
            continue
        p = Poly(B[0].subs({b: b0, c: c0, d: d0}), a)
        print(N(p.expr), '= 0')
        a0 = -p.nth(0)/p.nth(1)
        if a0 < 0 or a0 > 1:
            continue
        print('a0 =', N(a0))
        print('b0 =', N(b0))
        print('c0 =', N(c0))
        print('d0 =', N(d0))
        print('f0 =', N(f.subs({a: a0, b: b0, c: c0, d: d0})))

if __name__ == '__main__':
    main()
