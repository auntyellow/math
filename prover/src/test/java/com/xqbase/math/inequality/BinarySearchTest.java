package com.xqbase.math.inequality;

import java.util.logging.Handler;
import java.util.logging.Level;
import java.util.logging.LogManager;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import org.junit.Assert;
import org.junit.BeforeClass;
import org.junit.Test;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.xqbase.math.polys.Mono;
import com.xqbase.math.polys.Rational;
import com.xqbase.math.polys.RationalPoly;

public class BinarySearchTest {
	private static Logger log = LoggerFactory.getLogger(BinarySearchTest.class);

	private static final Rational INFINITY = Rational.valueOf(Long.MAX_VALUE);

	@BeforeClass
	public static void startup() {
		java.util.logging.Logger rootLogger = LogManager.getLogManager().getLogger("");
		rootLogger.setLevel(Level.INFO);
		for (Handler h : rootLogger.getHandlers()) {
			h.setLevel(Level.FINE);
		}
	}

	private static RationalPoly __(String vars, String expr) {
		return new RationalPoly(vars, expr);
	}

	private static String toString(Rational[] result) {
		return Stream.of(result).map(r -> r == null ? null : Double.valueOf(r.doubleValue())).
				collect(Collectors.toList()).toString();
	}

	private static void	positive(RationalPoly f) {
		Rational[] result = BinarySearch.search(f);
		if (result.length > 0) {
			Assert.fail("expected positive, actually " + toString(result));
		}
	}

	private static void	positive01(RationalPoly f) {
		log.info("search01 " + f);
		Rational[] result = BinarySearch.search01(f);
		if (result.length > 0) {
			Assert.fail("expected positive, actually " + toString(result));
		}
	}

	private static void	negative(RationalPoly f, int signum) {
		Rational[] result = BinarySearch.search(f);
		Assert.assertNotEquals(0, result.length);
		String vars = f.getVars();
		RationalPoly f1 = f;
		for (int i = 0; i < result.length - 1; i ++) {
			f1 = f1.subs(vars.charAt(i), result[i]);
		}
		Rational c0 = f1.remove(new Mono(vars.toString(), ""));
		if (c0 == null) {
			c0 = Rational.valueOf(0);
		}
		Assert.assertTrue(f1.isEmpty());
		Assert.assertEquals(result[result.length - 1], c0);
		Assert.assertEquals(signum, c0.signum());
	}

	private static void critical(RationalPoly f, Rational... x) {
		Rational[] result = BinarySearch.search(f);
		Assert.assertNotEquals(0, result.length);
		for (int i = 0; i < x.length; i ++) {
			Assert.assertEquals(x[i], result[i]);
		}
	}

	@Test
	public void testBasic() {
		negative(__("xy", "x**2 - 2*y"), 0);
		negative(__("xy", "-x**2 + 2*x + y"), -1);
		// 1e-22
		String e_22 = "1/10000000000000000000000";
		// fibonacci 91, 92
		long m = 4660046610375530309L;
		long n = 7540113804746346429L;
		// n*x - m can make minimum x < 1
		RationalPoly f = __("x", n + "*x - " + m);
		f = new RationalPoly("x").addMul(f, f);
		positive(__("x", e_22).add(f));
		negative(__("x", "-" + e_22).add(f), -1);
		/*
		// doesn't work due to critical points near (1, 3, 1) and (1, 2, 1, 1) 
		// (3*x - y)**2 + (x - z)**2
		f = __("xyz", "10*x**2 - 6*x*y - 2*x*z + y**2 + z**2");
		// (2*w - x)**2 + (w - y)**2 + (w - z)**2
		f = __("wxyz", "6*w**2 - 4*w*x - 2*w*y - 2*w*z + x**2 + y**2 + z**2");
		*/
		// luckily not stack overflow: x**2*y**2 + 16*y**2 - 24*y + 9 at (0, 3/4)
		critical(__("xy", "16*x**2 - 24*x*y + 9*y**2 + 1"), INFINITY, INFINITY);
		// - 30*x*y + ... + 1 causes so: 2*x**2*y**2 + 25*y**2 - 30*y + 9 = 0 at (0, 3/5)
		// - 30*x*y causes stack overflow: 25*x**2*y**2 - 30*x*y + 9 = 0 at x*y = 3/5
		positive(__("xy", "25*x**2 - 29*x*y + 9*y**2"));
		// + 1/4 causes so: 2*x**2*y**2 - 3*x*y + 1/4*y**2 + 1 = 0 at (1, 2/3)
		// remove + 1/5 causes so: y**2 - 3*y + 2 = 0 at y = 1
		negative(__("xy", "2*x**2 - 3*x*y + y**2 + 1/5"), -1);
		// luckily not so: x*y**2 + 16*y**2 - 24*y + 9 = 0 at (0, 3/4)
		critical(__("xy", "16*x**2 - 24*x*y + x + 9*y**2"), INFINITY, INFINITY);
		// - 40*x*y causes so: 25*x**2*y**2 - 30*x*y + 9 = 0 at x*y = 4/5
		positive(__("xy", "25*x**2 - 39*x*y + x + 16*y**2"));
		// - 30*x**2*y causes so: 25*y**2 - 30*y + 9 = 0 at y = 3/5
		// - 30*x**2*y + ... + 1 causes so: x**4*y**4 + 25*x**2 - 30*x + 9 = 0 at (0, 3/5)
		positive(__("xy", "9*x**4 - 29*x**2*y + 25*y**2"));
	}

	@Test
	public void testMathSE() {
		// https://math.stackexchange.com/q/3831395
		positive(__("x", "x**5 - 1/2*x**3 - x + 4/5"));
		// https://math.stackexchange.com/q/83670
		positive(__("x", "x**8 - x**7 + 2*x**6 - 2*x**5 + 3*x**4 - 3*x**3 + 4*x**2 - 4*x + 5/2"));
		// https://math.stackexchange.com/q/4765187
		// (1 + x)**7 - 7**(7/3)*x**4
		positive(__("x", "x**7 + 7*x**6 + 21*x**5 - 59*x**4 + 35*x**3 + 21*x**2 + 7*x + 1"));
		// https://math.stackexchange.com/q/1775572
		RationalPoly f = __("uv", "40*u**7*v**3 + 120*u**7*v**2 + 120*u**7*v + 65*u**7 + 40*u**6*v**4 + 376*u**6*v**3 + 888*u**6*v**2 + 768*u**6*v + 351*u**6 + 240*u**5*v**4 + 1416*u**5*v**3 + 2808*u**5*v**2 + 2088*u**5*v + 741*u**5 - 40*u**4*v**6 - 240*u**4*v**5 + 2079*u**4*v**3 + 4437*u**4*v**2 + 2997*u**4*v + 754*u**4 + 25*u**3*v**7 - 25*u**3*v**6 - 675*u**3*v**5 - 1286*u**3*v**4 + 546*u**3*v**3 + 3504*u**3*v**2 + 2412*u**3*v + 390*u**3 + 75*u**2*v**7 + 165*u**2*v**6 - 585*u**2*v**5 - 2058*u**2*v**4 - 1476*u**2*v**3 + 1170*u**2*v**2 + 1134*u**2*v + 156*u**2 + 75*u*v**7 + 181*u*v**6 - 489*u*v**5 - 2178*u*v**4 - 2698*u*v**3 - 1056*u*v**2 - 156*u*v + 65*v**7 + 351*v**6 + 741*v**5 + 754*v**4 + 390*v**3 + 156*v**2");
		positive(f);
		// https://math.stackexchange.com/q/4850712
		// from 4850712.py
		// m, n = 5, 13, non-negative, https://math.stackexchange.com/q/1777075
		f = __("uv", "65*u**5*v**2 + 130*u**5*v + 90*u**5 + 65*u**4*v**3 + 351*u**4*v**2 + 442*u**4*v + 216*u**4 - 65*u**3*v**4 + 508*u**3*v**2 + 496*u**3*v + 108*u**3 + 25*u**2*v**5 - 135*u**2*v**4 - 256*u**2*v**3 + 504*u**2*v**2 + 552*u**2*v + 72*u**2 + 50*u*v**5 - 244*u*v**4 - 928*u*v**3 - 516*u*v**2 - 72*u*v + 90*v**5 + 216*v**4 + 108*v**3 + 72*v**2");
		positive(f);
		// m, n = 63, 164, non-negative
		f = __("uv", "10332*u**5*v**2 + 20664*u**5*v + 14301*u**5 + 10332*u**4*v**3 + 55760*u**4*v**2 + 70192*u**4*v + 34277*u**4 - 10332*u**3*v**4 + 80655*u**3*v**2 + 78654*u**3*v + 17025*u**3 + 3969*u**2*v**5 - 21483*u**2*v**4 - 40703*u**2*v**3 + 80131*u**2*v**2 + 87706*u**2*v + 11350*u**2 + 7938*u*v**5 - 38866*u*v**4 - 147662*u*v**3 - 82031*u*v**2 - 11350*u*v + 14301*v**5 + 34277*v**4 + 17025*v**3 + 11350*v**2");
		positive(f);
		// m, n = 121, 315, negative
		f = __("uv", "38115*u**5*v**2 + 76230*u**5*v + 52756*u**5 + 38115*u**4*v**3 + 205695*u**4*v**2 + 258930*u**4*v + 126440*u**4 - 38115*u**3*v**4 + 297524*u**3*v**2 + 290128*u**3*v + 62784*u**3 + 14641*u**2*v**5 - 79255*u**2*v**4 - 150156*u**2*v**3 + 295608*u**2*v**2 + 323544*u**2*v + 41856*u**2 + 29282*u*v**5 - 143390*u*v**4 - 544752*u*v**3 - 302616*u*v**2 - 41856*u*v + 52756*v**5 + 126440*v**4 + 62784*v**3 + 41856*v**2");
		negative(f, -1);
		// https://math.stackexchange.com/q/2016364
		// results from 2016364.py, doesn't seem to work
		// f(----)
		f = __("abcd", "a**4 - 4*a**3 + a**2*b**2 - 2*a**2*b + a**2*d**2 - 2*a**2*d + 8*a**2 - 2*a*b**2 + 8*a*b*c*d + 8*a*b*c + 8*a*b*d + 12*a*b + 8*a*c*d + 8*a*c - 2*a*d**2 + 12*a*d + b**4 - 4*b**3 + b**2*c**2 - 2*b**2*c + 8*b**2 - 2*b*c**2 + 8*b*c*d + 12*b*c + 8*b*d + c**4 - 4*c**3 + c**2*d**2 - 2*c**2*d + 8*c**2 - 2*c*d**2 + 12*c*d + d**4 - 4*d**3 + 8*d**2");
		positive01(f);
		// f(---+), doesn't work due to f(1, 1, 1, 1) = 0
		f = __("abcd", "a**4 - 4*a**3 + a**2*b**2 - 2*a**2*b + a**2*d**2 + 2*a**2*d + 8*a**2 - 2*a*b**2 - 8*a*b*c*d + 8*a*b*c - 8*a*b*d + 12*a*b - 8*a*c*d + 8*a*c - 2*a*d**2 - 12*a*d + b**4 - 4*b**3 + b**2*c**2 - 2*b**2*c + 8*b**2 - 2*b*c**2 - 8*b*c*d + 12*b*c - 8*b*d + c**4 - 4*c**3 + c**2*d**2 + 2*c**2*d + 8*c**2 - 2*c*d**2 - 12*c*d + d**4 + 4*d**3 + 8*d**2");
		// positive01(f);
		// f(---+, d <= 3/4)
		f = __("abcd", "16*a**4 - 64*a**3 + 16*a**2*b**2 - 32*a**2*b + 4*a**2*d**2 + 16*a**2*d + 128*a**2 - 32*a*b**2 - 64*a*b*c*d + 128*a*b*c - 64*a*b*d + 192*a*b - 64*a*c*d + 128*a*c - 8*a*d**2 - 96*a*d + 16*b**4 - 64*b**3 + 16*b**2*c**2 - 32*b**2*c + 128*b**2 - 32*b*c**2 - 64*b*c*d + 192*b*c - 64*b*d + 16*c**4 - 64*c**3 + 4*c**2*d**2 + 16*c**2*d + 128*c**2 - 8*c*d**2 - 96*c*d + d**4 + 8*d**3 + 32*d**2");
		positive01(f);
		// f(---+, d >= 3/4)
		f = __("abcd", "16*a**4 + 16*a**2*b**2 + 4*a**2*d**2 - 32*a**2*d + 64*a**2 - 64*a*b*c*d + 128*a*b*d + 128*a*c*d - 256*a*d + 16*b**4 + 16*b**2*c**2 + 128*b*c*d - 256*b*d + 16*c**4 + 4*c**2*d**2 - 32*c**2*d + 64*c**2 - 256*c*d + d**4 - 16*d**3 + 96*d**2 + 256*d");
		// slow
		positive01(f);
		// f(--++)
		f = __("abcd", "a**4 - 4*a**3 + a**2*b**2 - 2*a**2*b + a**2*d**2 + 2*a**2*d + 8*a**2 - 2*a*b**2 + 8*a*b*c*d - 8*a*b*c - 8*a*b*d + 12*a*b + 8*a*c*d - 8*a*c - 2*a*d**2 - 12*a*d + b**4 - 4*b**3 + b**2*c**2 + 2*b**2*c + 8*b**2 - 2*b*c**2 + 8*b*c*d - 12*b*c - 8*b*d + c**4 + 4*c**3 + c**2*d**2 + 2*c**2*d + 8*c**2 + 2*c*d**2 + 12*c*d + d**4 + 4*d**3 + 8*d**2");
		positive01(f);
		// f(-+++)
		f = __("abcd", "a**4 - 4*a**3 + a**2*b**2 + 2*a**2*b + a**2*d**2 + 2*a**2*d + 8*a**2 - 2*a*b**2 - 8*a*b*c*d + 8*a*b*c + 8*a*b*d - 12*a*b + 8*a*c*d - 8*a*c - 2*a*d**2 - 12*a*d + b**4 + 4*b**3 + b**2*c**2 + 2*b**2*c + 8*b**2 + 2*b*c**2 - 8*b*c*d + 12*b*c + 8*b*d + c**4 + 4*c**3 + c**2*d**2 + 2*c**2*d + 8*c**2 + 2*c*d**2 + 12*c*d + d**4 + 4*d**3 + 8*d**2");
		positive01(f);
		// f(++++)
		f = __("abcd", "a**4 + 4*a**3 + a**2*b**2 + 2*a**2*b + a**2*d**2 + 2*a**2*d + 8*a**2 + 2*a*b**2 + 8*a*b*c*d - 8*a*b*c - 8*a*b*d + 12*a*b - 8*a*c*d + 8*a*c + 2*a*d**2 + 12*a*d + b**4 + 4*b**3 + b**2*c**2 + 2*b**2*c + 8*b**2 + 2*b*c**2 - 8*b*c*d + 12*b*c + 8*b*d + c**4 + 4*c**3 + c**2*d**2 + 2*c**2*d + 8*c**2 + 2*c*d**2 + 12*c*d + d**4 + 4*d**3 + 8*d**2");
		positive01(f);
		// f(-+-+), doesn't work due to f(a = max(abcd))(0, 1, 1, 1) = 0
		f = __("abcd", "a**4 - 4*a**3 + a**2*b**2 + 2*a**2*b + a**2*d**2 + 2*a**2*d + 8*a**2 - 2*a*b**2 + 8*a*b*c*d - 8*a*b*c + 8*a*b*d - 12*a*b - 8*a*c*d + 8*a*c - 2*a*d**2 - 12*a*d + b**4 + 4*b**3 + b**2*c**2 - 2*b**2*c + 8*b**2 + 2*b*c**2 + 8*b*c*d - 12*b*c + 8*b*d + c**4 - 4*c**3 + c**2*d**2 + 2*c**2*d + 8*c**2 - 2*c*d**2 - 12*c*d + d**4 + 4*d**3 + 8*d**2");
		// positive01(f);
		// f(a = max(abcd)) from f(-+-+)
		f = __("abcd", "a**2*b**4 + a**2*b**2*c**2 + a**2*b**2 + 8*a**2*b*c*d + a**2*c**4 + a**2*c**2*d**2 + a**2*d**4 + a**2*d**2 + a**2 + 4*a*b**3 - 2*a*b**2*c - 2*a*b**2 + 2*a*b*c**2 + 8*a*b*c*d - 8*a*b*c + 8*a*b*d + 2*a*b - 4*a*c**3 + 2*a*c**2*d - 2*a*c*d**2 - 8*a*c*d + 4*a*d**3 - 2*a*d**2 + 2*a*d - 4*a + 8*b**2 - 12*b*c + 8*b*d - 12*b + 8*c**2 - 12*c*d + 8*c + 8*d**2 - 12*d + 8");
		positive01(f.subs('b', __("abcd", "1 - b")).subs('c', __("abcd", "1 - c")).subs('d', __("abcd", "1 - d")));
		// f(a = max(abcd)) from f(+-+-)
		f = __("abcd", "a**2*b**4 + a**2*b**2*c**2 + a**2*b**2 + 8*a**2*b*c*d + a**2*c**4 + a**2*c**2*d**2 + a**2*d**4 + a**2*d**2 + a**2 - 4*a*b**3 + 2*a*b**2*c + 2*a*b**2 - 2*a*b*c**2 - 8*a*b*c*d + 8*a*b*c - 8*a*b*d - 2*a*b + 4*a*c**3 - 2*a*c**2*d + 2*a*c*d**2 + 8*a*c*d - 4*a*d**3 + 2*a*d**2 - 2*a*d + 4*a + 8*b**2 - 12*b*c + 8*b*d - 12*b + 8*c**2 - 12*c*d + 8*c + 8*d**2 - 12*d + 8");
		positive01(f.subs('b', __("abcd", "1 - b")).subs('c', __("abcd", "1 - c")).subs('d', __("abcd", "1 - d")));
	}

	@Test
	public void testYang08() {
		// ISBN 9787030207210, p156, ยง7.1
		RationalPoly f = __("z", "10195920*z**8 + 2109632*z**7 - 5387520*z**6 + 1361336*z**5 + 61445*z**4 - 52468*z**3 + 6350*z**2 - 300*z + 5");
		positive(f);
		// more steps for f - 1/29
		positive(__("z", "-1/29").add(f));
		// negative for f - 1/28
		negative(__("z", "-1/28").add(f), -1);
		// p172, problem 11, results from p172-11.py
		f = __("uv", "170172209*u**4 - 1301377672*u**3*v + 640688836*u**3 + 3553788598*u**2*v**2 - 3203444180*u**2*v + 640688836*u**2 - 3864133016*u*v**3 + 4484821852*u*v**2 - 1281377672*u*v + 1611722090*v**4 - 961033254*v**3 + 2082238717*v**2");
		positive01(f);
		f = __("uv", "2572755344*u**4 - 6426888360*u**3*v - 3844133016*u**3 + 5315682897*u**2*v**2 + 8649299286*u**2*v + 1441549881*u**2 - 1621722090*u*v**3 - 5766199524*u*v**2 - 2883099762*u*v + 1611722090*v**4 - 961033254*v**3 + 2082238717*v**2");
		positive01(f);
		f = __("uv", "2572755344*u**4 - 20000000*u**3*v - 3844133016*u**3 + 30000000*u**2*v**2 + 1441549881*u**2 - 20000000*u*v**3 + 170172209*v**4 + 640688836*v**3 + 640688836*v**2");
		positive01(f);
	}

	@Test
	public void testHan23() {
		// test cases from binary-search-0.py
		/*
		RationalPoly f = __("bcu", "5*b**6*c**3*u**6 + 12*b**6*c**3*u**5 + 3*b**6*c**3*u**4 - 8*b**6*c**3*u**3 + 3*b**6*c**3*u**2 + 12*b**6*c**3*u + 5*b**6*c**3 + 4*b**6*c**2*u**6 + 12*b**6*c**2*u**5 + 12*b**6*c**2*u**4 + 8*b**6*c**2*u**3 + 12*b**6*c**2*u**2 + 12*b**6*c**2*u + 4*b**6*c**2 + 4*b**6*c*u**5 + 10*b**6*c*u**4 + 12*b**6*c*u**3 + 10*b**6*c*u**2 + 4*b**6*c*u + 2*b**6*u**4 + 4*b**6*u**3 + 2*b**6*u**2 + 5*b**5*c**4*u**6 + 12*b**5*c**4*u**5 + 3*b**5*c**4*u**4 - 8*b**5*c**4*u**3 + 3*b**5*c**4*u**2 + 12*b**5*c**4*u + 5*b**5*c**4 + 16*b**5*c**3*u**6 + 24*b**5*c**3*u**5 - 12*b**5*c**3*u**4 - 4*b**5*c**3*u**3 + 60*b**5*c**3*u**2 + 60*b**5*c**3*u + 16*b**5*c**3 + 6*b**5*c**2*u**6 + 8*b**5*c**2*u**5 + 2*b**5*c**2*u**4 + 36*b**5*c**2*u**3 + 74*b**5*c**2*u**2 + 44*b**5*c**2*u + 6*b**5*c**2 + 2*b**5*c*u**5 + 2*b**5*c*u**4 + 22*b**5*c*u**3 + 28*b**5*c*u**2 + 6*b**5*c*u + b**5*u**4 + 2*b**5*u**3 + b**5*u**2 + 5*b**4*c**5*u**6 + 12*b**4*c**5*u**5 + 3*b**4*c**5*u**4 - 8*b**4*c**5*u**3 + 3*b**4*c**5*u**2 + 12*b**4*c**5*u + 5*b**4*c**5 + 24*b**4*c**4*u**6 + 36*b**4*c**4*u**5 - 36*b**4*c**4*u**4 - 60*b**4*c**4*u**3 + 36*b**4*c**4*u**2 + 72*b**4*c**4*u + 24*b**4*c**4 + 24*b**4*c**3*u**6 + 12*b**4*c**3*u**5 - 78*b**4*c**3*u**4 - 24*b**4*c**3*u**3 + 138*b**4*c**3*u**2 + 120*b**4*c**3*u + 24*b**4*c**3 + 4*b**4*c**2*u**6 - 32*b**4*c**2*u**4 + 24*b**4*c**2*u**3 + 92*b**4*c**2*u**2 + 44*b**4*c**2*u + 4*b**4*c**2 - 4*b**4*c*u**4 + 12*b**4*c*u**3 + 9*b**4*c*u**2 + 2*b**4*c*u + 16*b**3*c**5*u**6 + 36*b**3*c**5*u**5 - 40*b**3*c**5*u**3 + 36*b**3*c**5*u + 16*b**3*c**5 + 36*b**3*c**4*u**6 + 44*b**3*c**4*u**5 - 88*b**3*c**4*u**4 - 120*b**3*c**4*u**3 + 56*b**3*c**4*u**2 + 116*b**3*c**4*u + 36*b**3*c**4 + 16*b**3*c**3*u**6 + 8*b**3*c**3*u**5 - 88*b**3*c**3*u**4 - 44*b**3*c**3*u**3 + 108*b**3*c**3*u**2 + 88*b**3*c**3*u + 16*b**3*c**3 + b**3*c**2*u**6 + 2*b**3*c**2*u**5 - 24*b**3*c**2*u**4 + 12*b**3*c**2*u**3 + 28*b**3*c**2*u**2 + 10*b**3*c**2*u + b**3*c**2 + 18*b**2*c**5*u**6 + 40*b**2*c**5*u**5 - 8*b**2*c**5*u**4 - 60*b**2*c**5*u**3 - 8*b**2*c**5*u**2 + 40*b**2*c**5*u + 18*b**2*c**5 + 20*b**2*c**4*u**6 + 30*b**2*c**4*u**5 - 64*b**2*c**4*u**4 - 90*b**2*c**4*u**3 + 34*b**2*c**4*u**2 + 70*b**2*c**4*u + 20*b**2*c**4 + 3*b**2*c**3*u**6 + 8*b**2*c**3*u**5 - 34*b**2*c**3*u**4 - 14*b**2*c**3*u**3 + 31*b**2*c**3*u**2 + 18*b**2*c**3*u + 3*b**2*c**3 + 8*b*c**5*u**6 + 20*b*c**5*u**5 - 6*b*c**5*u**4 - 36*b*c**5*u**3 - 6*b*c**5*u**2 + 20*b*c**5*u + 8*b*c**5 + 3*b*c**4*u**6 + 10*b*c**4*u**5 - 16*b*c**4*u**4 - 24*b*c**4*u**3 + 10*b*c**4*u**2 + 14*b*c**4*u + 3*b*c**4 + c**5*u**6 + 4*c**5*u**5 - c**5*u**4 - 8*c**5*u**3 - c**5*u**2 + 4*c**5*u + c**5");
		positive01(f.subs('u', __("bcu", "1/2*u")));
		f = __("bcu", "5*b**4*c**5*u**6 + 24*b**4*c**5*u**5 + 12*b**4*c**5*u**4 - 64*b**4*c**5*u**3 + 48*b**4*c**5*u**2 + 384*b**4*c**5*u + 320*b**4*c**5 + 5*b**4*c**4*u**6 + 24*b**4*c**4*u**5 + 12*b**4*c**4*u**4 - 64*b**4*c**4*u**3 + 48*b**4*c**4*u**2 + 384*b**4*c**4*u + 320*b**4*c**4 + 5*b**4*c**3*u**6 + 24*b**4*c**3*u**5 + 12*b**4*c**3*u**4 - 64*b**4*c**3*u**3 + 48*b**4*c**3*u**2 + 384*b**4*c**3*u + 320*b**4*c**3 + 16*b**3*c**5*u**6 + 72*b**3*c**5*u**5 - 320*b**3*c**5*u**3 + 1152*b**3*c**5*u + 1024*b**3*c**5 + 24*b**3*c**4*u**6 + 72*b**3*c**4*u**5 - 144*b**3*c**4*u**4 - 480*b**3*c**4*u**3 + 576*b**3*c**4*u**2 + 2304*b**3*c**4*u + 1536*b**3*c**4 + 16*b**3*c**3*u**6 + 48*b**3*c**3*u**5 - 48*b**3*c**3*u**4 - 32*b**3*c**3*u**3 + 960*b**3*c**3*u**2 + 1920*b**3*c**3*u + 1024*b**3*c**3 + 4*b**3*c**2*u**6 + 24*b**3*c**2*u**5 + 48*b**3*c**2*u**4 + 64*b**3*c**2*u**3 + 192*b**3*c**2*u**2 + 384*b**3*c**2*u + 256*b**3*c**2 + 18*b**2*c**5*u**6 + 80*b**2*c**5*u**5 - 32*b**2*c**5*u**4 - 480*b**2*c**5*u**3 - 128*b**2*c**5*u**2 + 1280*b**2*c**5*u + 1152*b**2*c**5 + 36*b**2*c**4*u**6 + 88*b**2*c**4*u**5 - 352*b**2*c**4*u**4 - 960*b**2*c**4*u**3 + 896*b**2*c**4*u**2 + 3712*b**2*c**4*u + 2304*b**2*c**4 + 24*b**2*c**3*u**6 + 24*b**2*c**3*u**5 - 312*b**2*c**3*u**4 - 192*b**2*c**3*u**3 + 2208*b**2*c**3*u**2 + 3840*b**2*c**3*u + 1536*b**2*c**3 + 6*b**2*c**2*u**6 + 16*b**2*c**2*u**5 + 8*b**2*c**2*u**4 + 288*b**2*c**2*u**3 + 1184*b**2*c**2*u**2 + 1408*b**2*c**2*u + 384*b**2*c**2 + 8*b**2*c*u**5 + 40*b**2*c*u**4 + 96*b**2*c*u**3 + 160*b**2*c*u**2 + 128*b**2*c*u + 8*b*c**5*u**6 + 40*b*c**5*u**5 - 24*b*c**5*u**4 - 288*b*c**5*u**3 - 96*b*c**5*u**2 + 640*b*c**5*u + 512*b*c**5 + 20*b*c**4*u**6 + 60*b*c**4*u**5 - 256*b*c**4*u**4 - 720*b*c**4*u**3 + 544*b*c**4*u**2 + 2240*b*c**4*u + 1280*b*c**4 + 16*b*c**3*u**6 + 16*b*c**3*u**5 - 352*b*c**3*u**4 - 352*b*c**3*u**3 + 1728*b*c**3*u**2 + 2816*b*c**3*u + 1024*b*c**3 + 4*b*c**2*u**6 - 128*b*c**2*u**4 + 192*b*c**2*u**3 + 1472*b*c**2*u**2 + 1408*b*c**2*u + 256*b*c**2 + 4*b*c*u**5 + 8*b*c*u**4 + 176*b*c*u**3 + 448*b*c*u**2 + 192*b*c*u + 8*b*u**4 + 32*b*u**3 + 32*b*u**2 + c**5*u**6 + 8*c**5*u**5 - 4*c**5*u**4 - 64*c**5*u**3 - 16*c**5*u**2 + 128*c**5*u + 64*c**5 + 3*c**4*u**6 + 20*c**4*u**5 - 64*c**4*u**4 - 192*c**4*u**3 + 160*c**4*u**2 + 448*c**4*u + 192*c**4 + 3*c**3*u**6 + 16*c**3*u**5 - 136*c**3*u**4 - 112*c**3*u**3 + 496*c**3*u**2 + 576*c**3*u + 192*c**3 + c**2*u**6 + 4*c**2*u**5 - 96*c**2*u**4 + 96*c**2*u**3 + 448*c**2*u**2 + 320*c**2*u + 64*c**2 - 16*c*u**4 + 96*c*u**3 + 144*c*u**2 + 64*c*u + 4*u**4 + 16*u**3 + 16*u**2");
		positive01(f);
		f = __("xyz", "9*x**8 + 16*x**6 - 30*x**4*y**3 - 56*x**3*z**2 + 25*y**6 + 49*z**4");
		positive01(f);
		System.exit(0);
		*/
		// ISBN 9787312056185, p341, ex 11.7
		// g from han23-p341s.py, v = u
		RationalPoly f = __("bcu", "b**6*u**6 + 4*b**6*u**5 - b**6*u**4 - 8*b**6*u**3 - b**6*u**2 + 4*b**6*u + b**6 + 3*b**5*c*u**6 + 10*b**5*c*u**5 - 16*b**5*c*u**4 - 24*b**5*c*u**3 + 10*b**5*c*u**2 + 14*b**5*c*u + 3*b**5*c + 8*b**5*u**6 + 20*b**5*u**5 - 6*b**5*u**4 - 36*b**5*u**3 - 6*b**5*u**2 + 20*b**5*u + 8*b**5 + 3*b**4*c**2*u**6 + 8*b**4*c**2*u**5 - 34*b**4*c**2*u**4 - 14*b**4*c**2*u**3 + 31*b**4*c**2*u**2 + 18*b**4*c**2*u + 3*b**4*c**2 + 20*b**4*c*u**6 + 30*b**4*c*u**5 - 64*b**4*c*u**4 - 90*b**4*c*u**3 + 34*b**4*c*u**2 + 70*b**4*c*u + 20*b**4*c + 18*b**4*u**6 + 40*b**4*u**5 - 8*b**4*u**4 - 60*b**4*u**3 - 8*b**4*u**2 + 40*b**4*u + 18*b**4 + b**3*c**3*u**6 + 2*b**3*c**3*u**5 - 24*b**3*c**3*u**4 + 12*b**3*c**3*u**3 + 28*b**3*c**3*u**2 + 10*b**3*c**3*u + b**3*c**3 + 16*b**3*c**2*u**6 + 8*b**3*c**2*u**5 - 88*b**3*c**2*u**4 - 44*b**3*c**2*u**3 + 108*b**3*c**2*u**2 + 88*b**3*c**2*u + 16*b**3*c**2 + 36*b**3*c*u**6 + 44*b**3*c*u**5 - 88*b**3*c*u**4 - 120*b**3*c*u**3 + 56*b**3*c*u**2 + 116*b**3*c*u + 36*b**3*c + 16*b**3*u**6 + 36*b**3*u**5 - 40*b**3*u**3 + 36*b**3*u + 16*b**3 - 4*b**2*c**4*u**4 + 12*b**2*c**4*u**3 + 9*b**2*c**4*u**2 + 2*b**2*c**4*u + 4*b**2*c**3*u**6 - 32*b**2*c**3*u**4 + 24*b**2*c**3*u**3 + 92*b**2*c**3*u**2 + 44*b**2*c**3*u + 4*b**2*c**3 + 24*b**2*c**2*u**6 + 12*b**2*c**2*u**5 - 78*b**2*c**2*u**4 - 24*b**2*c**2*u**3 + 138*b**2*c**2*u**2 + 120*b**2*c**2*u + 24*b**2*c**2 + 24*b**2*c*u**6 + 36*b**2*c*u**5 - 36*b**2*c*u**4 - 60*b**2*c*u**3 + 36*b**2*c*u**2 + 72*b**2*c*u + 24*b**2*c + 5*b**2*u**6 + 12*b**2*u**5 + 3*b**2*u**4 - 8*b**2*u**3 + 3*b**2*u**2 + 12*b**2*u + 5*b**2 + b*c**5*u**4 + 2*b*c**5*u**3 + b*c**5*u**2 + 2*b*c**4*u**5 + 2*b*c**4*u**4 + 22*b*c**4*u**3 + 28*b*c**4*u**2 + 6*b*c**4*u + 6*b*c**3*u**6 + 8*b*c**3*u**5 + 2*b*c**3*u**4 + 36*b*c**3*u**3 + 74*b*c**3*u**2 + 44*b*c**3*u + 6*b*c**3 + 16*b*c**2*u**6 + 24*b*c**2*u**5 - 12*b*c**2*u**4 - 4*b*c**2*u**3 + 60*b*c**2*u**2 + 60*b*c**2*u + 16*b*c**2 + 5*b*c*u**6 + 12*b*c*u**5 + 3*b*c*u**4 - 8*b*c*u**3 + 3*b*c*u**2 + 12*b*c*u + 5*b*c + 2*c**5*u**4 + 4*c**5*u**3 + 2*c**5*u**2 + 4*c**4*u**5 + 10*c**4*u**4 + 12*c**4*u**3 + 10*c**4*u**2 + 4*c**4*u + 4*c**3*u**6 + 12*c**3*u**5 + 12*c**3*u**4 + 8*c**3*u**3 + 12*c**3*u**2 + 12*c**3*u + 4*c**3 + 5*c**2*u**6 + 12*c**2*u**5 + 3*c**2*u**4 - 8*c**2*u**3 + 3*c**2*u**2 + 12*c**2*u + 5*c**2");
		// positive(f) doesn't work due to f(+--)(0, ?, 1) = 0
		positive01(f);
		// f(+--)
		f = __("bcu", "2*b**6*c**5*u**4 + 4*b**6*c**5*u**3 + 2*b**6*c**5*u**2 + 4*b**6*c**4*u**5 + 10*b**6*c**4*u**4 + 12*b**6*c**4*u**3 + 10*b**6*c**4*u**2 + 4*b**6*c**4*u + 4*b**6*c**3*u**6 + 12*b**6*c**3*u**5 + 12*b**6*c**3*u**4 + 8*b**6*c**3*u**3 + 12*b**6*c**3*u**2 + 12*b**6*c**3*u + 4*b**6*c**3 + 5*b**6*c**2*u**6 + 12*b**6*c**2*u**5 + 3*b**6*c**2*u**4 - 8*b**6*c**2*u**3 + 3*b**6*c**2*u**2 + 12*b**6*c**2*u + 5*b**6*c**2 + b**5*c**5*u**4 + 2*b**5*c**5*u**3 + b**5*c**5*u**2 + 2*b**5*c**4*u**5 + 2*b**5*c**4*u**4 + 22*b**5*c**4*u**3 + 28*b**5*c**4*u**2 + 6*b**5*c**4*u + 6*b**5*c**3*u**6 + 8*b**5*c**3*u**5 + 2*b**5*c**3*u**4 + 36*b**5*c**3*u**3 + 74*b**5*c**3*u**2 + 44*b**5*c**3*u + 6*b**5*c**3 + 16*b**5*c**2*u**6 + 24*b**5*c**2*u**5 - 12*b**5*c**2*u**4 - 4*b**5*c**2*u**3 + 60*b**5*c**2*u**2 + 60*b**5*c**2*u + 16*b**5*c**2 + 5*b**5*c*u**6 + 12*b**5*c*u**5 + 3*b**5*c*u**4 - 8*b**5*c*u**3 + 3*b**5*c*u**2 + 12*b**5*c*u + 5*b**5*c - 4*b**4*c**4*u**4 + 12*b**4*c**4*u**3 + 9*b**4*c**4*u**2 + 2*b**4*c**4*u + 4*b**4*c**3*u**6 - 32*b**4*c**3*u**4 + 24*b**4*c**3*u**3 + 92*b**4*c**3*u**2 + 44*b**4*c**3*u + 4*b**4*c**3 + 24*b**4*c**2*u**6 + 12*b**4*c**2*u**5 - 78*b**4*c**2*u**4 - 24*b**4*c**2*u**3 + 138*b**4*c**2*u**2 + 120*b**4*c**2*u + 24*b**4*c**2 + 24*b**4*c*u**6 + 36*b**4*c*u**5 - 36*b**4*c*u**4 - 60*b**4*c*u**3 + 36*b**4*c*u**2 + 72*b**4*c*u + 24*b**4*c + 5*b**4*u**6 + 12*b**4*u**5 + 3*b**4*u**4 - 8*b**4*u**3 + 3*b**4*u**2 + 12*b**4*u + 5*b**4 + b**3*c**3*u**6 + 2*b**3*c**3*u**5 - 24*b**3*c**3*u**4 + 12*b**3*c**3*u**3 + 28*b**3*c**3*u**2 + 10*b**3*c**3*u + b**3*c**3 + 16*b**3*c**2*u**6 + 8*b**3*c**2*u**5 - 88*b**3*c**2*u**4 - 44*b**3*c**2*u**3 + 108*b**3*c**2*u**2 + 88*b**3*c**2*u + 16*b**3*c**2 + 36*b**3*c*u**6 + 44*b**3*c*u**5 - 88*b**3*c*u**4 - 120*b**3*c*u**3 + 56*b**3*c*u**2 + 116*b**3*c*u + 36*b**3*c + 16*b**3*u**6 + 36*b**3*u**5 - 40*b**3*u**3 + 36*b**3*u + 16*b**3 + 3*b**2*c**2*u**6 + 8*b**2*c**2*u**5 - 34*b**2*c**2*u**4 - 14*b**2*c**2*u**3 + 31*b**2*c**2*u**2 + 18*b**2*c**2*u + 3*b**2*c**2 + 20*b**2*c*u**6 + 30*b**2*c*u**5 - 64*b**2*c*u**4 - 90*b**2*c*u**3 + 34*b**2*c*u**2 + 70*b**2*c*u + 20*b**2*c + 18*b**2*u**6 + 40*b**2*u**5 - 8*b**2*u**4 - 60*b**2*u**3 - 8*b**2*u**2 + 40*b**2*u + 18*b**2 + 3*b*c*u**6 + 10*b*c*u**5 - 16*b*c*u**4 - 24*b*c*u**3 + 10*b*c*u**2 + 14*b*c*u + 3*b*c + 8*b*u**6 + 20*b*u**5 - 6*b*u**4 - 36*b*u**3 - 6*b*u**2 + 20*b*u + 8*b + u**6 + 4*u**5 - u**4 - 8*u**3 - u**2 + 4*u + 1");
		positive01(f.subs('u', __("bcu", "1 - u")));
		// f(-+-)
		f = __("bcu", "b**6*c**5*u**6 + 4*b**6*c**5*u**5 - b**6*c**5*u**4 - 8*b**6*c**5*u**3 - b**6*c**5*u**2 + 4*b**6*c**5*u + b**6*c**5 + 8*b**5*c**5*u**6 + 20*b**5*c**5*u**5 - 6*b**5*c**5*u**4 - 36*b**5*c**5*u**3 - 6*b**5*c**5*u**2 + 20*b**5*c**5*u + 8*b**5*c**5 + 3*b**5*c**4*u**6 + 10*b**5*c**4*u**5 - 16*b**5*c**4*u**4 - 24*b**5*c**4*u**3 + 10*b**5*c**4*u**2 + 14*b**5*c**4*u + 3*b**5*c**4 + 18*b**4*c**5*u**6 + 40*b**4*c**5*u**5 - 8*b**4*c**5*u**4 - 60*b**4*c**5*u**3 - 8*b**4*c**5*u**2 + 40*b**4*c**5*u + 18*b**4*c**5 + 20*b**4*c**4*u**6 + 30*b**4*c**4*u**5 - 64*b**4*c**4*u**4 - 90*b**4*c**4*u**3 + 34*b**4*c**4*u**2 + 70*b**4*c**4*u + 20*b**4*c**4 + 3*b**4*c**3*u**6 + 8*b**4*c**3*u**5 - 34*b**4*c**3*u**4 - 14*b**4*c**3*u**3 + 31*b**4*c**3*u**2 + 18*b**4*c**3*u + 3*b**4*c**3 + 16*b**3*c**5*u**6 + 36*b**3*c**5*u**5 - 40*b**3*c**5*u**3 + 36*b**3*c**5*u + 16*b**3*c**5 + 36*b**3*c**4*u**6 + 44*b**3*c**4*u**5 - 88*b**3*c**4*u**4 - 120*b**3*c**4*u**3 + 56*b**3*c**4*u**2 + 116*b**3*c**4*u + 36*b**3*c**4 + 16*b**3*c**3*u**6 + 8*b**3*c**3*u**5 - 88*b**3*c**3*u**4 - 44*b**3*c**3*u**3 + 108*b**3*c**3*u**2 + 88*b**3*c**3*u + 16*b**3*c**3 + b**3*c**2*u**6 + 2*b**3*c**2*u**5 - 24*b**3*c**2*u**4 + 12*b**3*c**2*u**3 + 28*b**3*c**2*u**2 + 10*b**3*c**2*u + b**3*c**2 + 5*b**2*c**5*u**6 + 12*b**2*c**5*u**5 + 3*b**2*c**5*u**4 - 8*b**2*c**5*u**3 + 3*b**2*c**5*u**2 + 12*b**2*c**5*u + 5*b**2*c**5 + 24*b**2*c**4*u**6 + 36*b**2*c**4*u**5 - 36*b**2*c**4*u**4 - 60*b**2*c**4*u**3 + 36*b**2*c**4*u**2 + 72*b**2*c**4*u + 24*b**2*c**4 + 24*b**2*c**3*u**6 + 12*b**2*c**3*u**5 - 78*b**2*c**3*u**4 - 24*b**2*c**3*u**3 + 138*b**2*c**3*u**2 + 120*b**2*c**3*u + 24*b**2*c**3 + 4*b**2*c**2*u**6 - 32*b**2*c**2*u**4 + 24*b**2*c**2*u**3 + 92*b**2*c**2*u**2 + 44*b**2*c**2*u + 4*b**2*c**2 - 4*b**2*c*u**4 + 12*b**2*c*u**3 + 9*b**2*c*u**2 + 2*b**2*c*u + 5*b*c**4*u**6 + 12*b*c**4*u**5 + 3*b*c**4*u**4 - 8*b*c**4*u**3 + 3*b*c**4*u**2 + 12*b*c**4*u + 5*b*c**4 + 16*b*c**3*u**6 + 24*b*c**3*u**5 - 12*b*c**3*u**4 - 4*b*c**3*u**3 + 60*b*c**3*u**2 + 60*b*c**3*u + 16*b*c**3 + 6*b*c**2*u**6 + 8*b*c**2*u**5 + 2*b*c**2*u**4 + 36*b*c**2*u**3 + 74*b*c**2*u**2 + 44*b*c**2*u + 6*b*c**2 + 2*b*c*u**5 + 2*b*c*u**4 + 22*b*c*u**3 + 28*b*c*u**2 + 6*b*c*u + b*u**4 + 2*b*u**3 + b*u**2 + 5*c**3*u**6 + 12*c**3*u**5 + 3*c**3*u**4 - 8*c**3*u**3 + 3*c**3*u**2 + 12*c**3*u + 5*c**3 + 4*c**2*u**6 + 12*c**2*u**5 + 12*c**2*u**4 + 8*c**2*u**3 + 12*c**2*u**2 + 12*c**2*u + 4*c**2 + 4*c*u**5 + 10*c*u**4 + 12*c*u**3 + 10*c*u**2 + 4*c*u + 2*u**4 + 4*u**3 + 2*u**2");
		positive01(f);
		// f(++-), doesn't work due to to f(0, 0, ?) = f(0, ?, 1) = f(?, 0, 0) = 0
		f = __("bcu", "5*b**6*c**3*u**6 + 12*b**6*c**3*u**5 + 3*b**6*c**3*u**4 - 8*b**6*c**3*u**3 + 3*b**6*c**3*u**2 + 12*b**6*c**3*u + 5*b**6*c**3 + 4*b**6*c**2*u**6 + 12*b**6*c**2*u**5 + 12*b**6*c**2*u**4 + 8*b**6*c**2*u**3 + 12*b**6*c**2*u**2 + 12*b**6*c**2*u + 4*b**6*c**2 + 4*b**6*c*u**5 + 10*b**6*c*u**4 + 12*b**6*c*u**3 + 10*b**6*c*u**2 + 4*b**6*c*u + 2*b**6*u**4 + 4*b**6*u**3 + 2*b**6*u**2 + 5*b**5*c**4*u**6 + 12*b**5*c**4*u**5 + 3*b**5*c**4*u**4 - 8*b**5*c**4*u**3 + 3*b**5*c**4*u**2 + 12*b**5*c**4*u + 5*b**5*c**4 + 16*b**5*c**3*u**6 + 24*b**5*c**3*u**5 - 12*b**5*c**3*u**4 - 4*b**5*c**3*u**3 + 60*b**5*c**3*u**2 + 60*b**5*c**3*u + 16*b**5*c**3 + 6*b**5*c**2*u**6 + 8*b**5*c**2*u**5 + 2*b**5*c**2*u**4 + 36*b**5*c**2*u**3 + 74*b**5*c**2*u**2 + 44*b**5*c**2*u + 6*b**5*c**2 + 2*b**5*c*u**5 + 2*b**5*c*u**4 + 22*b**5*c*u**3 + 28*b**5*c*u**2 + 6*b**5*c*u + b**5*u**4 + 2*b**5*u**3 + b**5*u**2 + 5*b**4*c**5*u**6 + 12*b**4*c**5*u**5 + 3*b**4*c**5*u**4 - 8*b**4*c**5*u**3 + 3*b**4*c**5*u**2 + 12*b**4*c**5*u + 5*b**4*c**5 + 24*b**4*c**4*u**6 + 36*b**4*c**4*u**5 - 36*b**4*c**4*u**4 - 60*b**4*c**4*u**3 + 36*b**4*c**4*u**2 + 72*b**4*c**4*u + 24*b**4*c**4 + 24*b**4*c**3*u**6 + 12*b**4*c**3*u**5 - 78*b**4*c**3*u**4 - 24*b**4*c**3*u**3 + 138*b**4*c**3*u**2 + 120*b**4*c**3*u + 24*b**4*c**3 + 4*b**4*c**2*u**6 - 32*b**4*c**2*u**4 + 24*b**4*c**2*u**3 + 92*b**4*c**2*u**2 + 44*b**4*c**2*u + 4*b**4*c**2 - 4*b**4*c*u**4 + 12*b**4*c*u**3 + 9*b**4*c*u**2 + 2*b**4*c*u + 16*b**3*c**5*u**6 + 36*b**3*c**5*u**5 - 40*b**3*c**5*u**3 + 36*b**3*c**5*u + 16*b**3*c**5 + 36*b**3*c**4*u**6 + 44*b**3*c**4*u**5 - 88*b**3*c**4*u**4 - 120*b**3*c**4*u**3 + 56*b**3*c**4*u**2 + 116*b**3*c**4*u + 36*b**3*c**4 + 16*b**3*c**3*u**6 + 8*b**3*c**3*u**5 - 88*b**3*c**3*u**4 - 44*b**3*c**3*u**3 + 108*b**3*c**3*u**2 + 88*b**3*c**3*u + 16*b**3*c**3 + b**3*c**2*u**6 + 2*b**3*c**2*u**5 - 24*b**3*c**2*u**4 + 12*b**3*c**2*u**3 + 28*b**3*c**2*u**2 + 10*b**3*c**2*u + b**3*c**2 + 18*b**2*c**5*u**6 + 40*b**2*c**5*u**5 - 8*b**2*c**5*u**4 - 60*b**2*c**5*u**3 - 8*b**2*c**5*u**2 + 40*b**2*c**5*u + 18*b**2*c**5 + 20*b**2*c**4*u**6 + 30*b**2*c**4*u**5 - 64*b**2*c**4*u**4 - 90*b**2*c**4*u**3 + 34*b**2*c**4*u**2 + 70*b**2*c**4*u + 20*b**2*c**4 + 3*b**2*c**3*u**6 + 8*b**2*c**3*u**5 - 34*b**2*c**3*u**4 - 14*b**2*c**3*u**3 + 31*b**2*c**3*u**2 + 18*b**2*c**3*u + 3*b**2*c**3 + 8*b*c**5*u**6 + 20*b*c**5*u**5 - 6*b*c**5*u**4 - 36*b*c**5*u**3 - 6*b*c**5*u**2 + 20*b*c**5*u + 8*b*c**5 + 3*b*c**4*u**6 + 10*b*c**4*u**5 - 16*b*c**4*u**4 - 24*b*c**4*u**3 + 10*b*c**4*u**2 + 14*b*c**4*u + 3*b*c**4 + c**5*u**6 + 4*c**5*u**5 - c**5*u**4 - 8*c**5*u**3 - c**5*u**2 + 4*c**5*u + c**5");
		// TODO doesn't work
		positive01(f.subs('u', __("bcu", "1/2*u")));
		positive01(f.subs('u', __("bcu", "1 - 1/2*u")));
		// ISBN 9787312056185, p354, ex 11.20 (p113, ex 5.26)
		// f from han23-p354u.py
		// FIXME no max-subs
		f = __("RStUVw", "4*R**4*S**4*U**2*V**2*t**2*w + 8*R**4*S**4*U**2*V**2*t*w + 4*R**4*S**4*U**2*V**2*w + R**4*S**2*U**2*V**4*t**2*w**2 + 2*R**4*S**2*U**2*V**4*t**2*w + R**4*S**2*U**2*V**4*t**2 + 2*R**4*S**2*U**2*V**4*t*w**2 + 4*R**4*S**2*U**2*V**4*t*w + 2*R**4*S**2*U**2*V**4*t + R**4*S**2*U**2*V**4*w**2 + 2*R**4*S**2*U**2*V**4*w + R**4*S**2*U**2*V**4 + 2*R**4*S**2*U**2*V**2*t**2*w**2 - 4*R**4*S**2*U**2*V**2*t**2*w + 2*R**4*S**2*U**2*V**2*t**2 + 4*R**4*S**2*U**2*V**2*t*w**2 - 8*R**4*S**2*U**2*V**2*t*w + 4*R**4*S**2*U**2*V**2*t + 2*R**4*S**2*U**2*V**2*w**2 - 4*R**4*S**2*U**2*V**2*w + 2*R**4*S**2*U**2*V**2 + R**4*S**2*U**2*t**2*w**2 + 2*R**4*S**2*U**2*t**2*w + R**4*S**2*U**2*t**2 + 2*R**4*S**2*U**2*t*w**2 + 4*R**4*S**2*U**2*t*w + 2*R**4*S**2*U**2*t + R**4*S**2*U**2*w**2 + 2*R**4*S**2*U**2*w + R**4*S**2*U**2 + 4*R**4*U**2*V**2*t**2*w + 8*R**4*U**2*V**2*t*w + 4*R**4*U**2*V**2*w - 2*R**3*S**3*U**3*V**3*t**2*w**2 + 2*R**3*S**3*U**3*V**3*t**2 + 2*R**3*S**3*U**3*V**3*w**2 - 2*R**3*S**3*U**3*V**3 + 2*R**3*S**3*U**3*V*t**2*w**2 - 2*R**3*S**3*U**3*V*t**2 - 2*R**3*S**3*U**3*V*w**2 + 2*R**3*S**3*U**3*V + 8*R**3*S**3*U**2*V**2*t**2*w**2 - 16*R**3*S**3*U**2*V**2*t**2*w + 8*R**3*S**3*U**2*V**2*t**2 - 8*R**3*S**3*U**2*V**2*w**2 + 16*R**3*S**3*U**2*V**2*w - 8*R**3*S**3*U**2*V**2 + 2*R**3*S**3*U*V**3*t**2*w**2 - 2*R**3*S**3*U*V**3*t**2 - 2*R**3*S**3*U*V**3*w**2 + 2*R**3*S**3*U*V**3 - 2*R**3*S**3*U*V*t**2*w**2 + 2*R**3*S**3*U*V*t**2 + 2*R**3*S**3*U*V*w**2 - 2*R**3*S**3*U*V + 2*R**3*S*U**3*V**3*t**2*w**2 - 2*R**3*S*U**3*V**3*t**2 - 2*R**3*S*U**3*V**3*w**2 + 2*R**3*S*U**3*V**3 - 2*R**3*S*U**3*V*t**2*w**2 + 2*R**3*S*U**3*V*t**2 + 2*R**3*S*U**3*V*w**2 - 2*R**3*S*U**3*V - 8*R**3*S*U**2*V**2*t**2*w**2 + 16*R**3*S*U**2*V**2*t**2*w - 8*R**3*S*U**2*V**2*t**2 + 8*R**3*S*U**2*V**2*w**2 - 16*R**3*S*U**2*V**2*w + 8*R**3*S*U**2*V**2 - 2*R**3*S*U*V**3*t**2*w**2 + 2*R**3*S*U*V**3*t**2 + 2*R**3*S*U*V**3*w**2 - 2*R**3*S*U*V**3 + 2*R**3*S*U*V*t**2*w**2 - 2*R**3*S*U*V*t**2 - 2*R**3*S*U*V*w**2 + 2*R**3*S*U*V + R**2*S**4*U**4*V**2*t**2*w**2 + 2*R**2*S**4*U**4*V**2*t**2*w + R**2*S**4*U**4*V**2*t**2 + 2*R**2*S**4*U**4*V**2*t*w**2 + 4*R**2*S**4*U**4*V**2*t*w + 2*R**2*S**4*U**4*V**2*t + R**2*S**4*U**4*V**2*w**2 + 2*R**2*S**4*U**4*V**2*w + R**2*S**4*U**4*V**2 + 2*R**2*S**4*U**2*V**2*t**2*w**2 - 4*R**2*S**4*U**2*V**2*t**2*w + 2*R**2*S**4*U**2*V**2*t**2 + 4*R**2*S**4*U**2*V**2*t*w**2 - 8*R**2*S**4*U**2*V**2*t*w + 4*R**2*S**4*U**2*V**2*t + 2*R**2*S**4*U**2*V**2*w**2 - 4*R**2*S**4*U**2*V**2*w + 2*R**2*S**4*U**2*V**2 + R**2*S**4*V**2*t**2*w**2 + 2*R**2*S**4*V**2*t**2*w + R**2*S**4*V**2*t**2 + 2*R**2*S**4*V**2*t*w**2 + 4*R**2*S**4*V**2*t*w + 2*R**2*S**4*V**2*t + R**2*S**4*V**2*w**2 + 2*R**2*S**4*V**2*w + R**2*S**4*V**2 + 4*R**2*S**2*U**4*V**4*t*w**2 + 8*R**2*S**2*U**4*V**4*t*w + 4*R**2*S**2*U**4*V**4*t + 2*R**2*S**2*U**4*V**2*t**2*w**2 + 4*R**2*S**2*U**4*V**2*t**2*w + 2*R**2*S**2*U**4*V**2*t**2 - 4*R**2*S**2*U**4*V**2*t*w**2 - 8*R**2*S**2*U**4*V**2*t*w - 4*R**2*S**2*U**4*V**2*t + 2*R**2*S**2*U**4*V**2*w**2 + 4*R**2*S**2*U**4*V**2*w + 2*R**2*S**2*U**4*V**2 + 4*R**2*S**2*U**4*t*w**2 + 8*R**2*S**2*U**4*t*w + 4*R**2*S**2*U**4*t + 8*R**2*S**2*U**3*V**3*t**2*w**2 - 8*R**2*S**2*U**3*V**3*t**2 - 16*R**2*S**2*U**3*V**3*t*w**2 + 16*R**2*S**2*U**3*V**3*t + 8*R**2*S**2*U**3*V**3*w**2 - 8*R**2*S**2*U**3*V**3 - 8*R**2*S**2*U**3*V*t**2*w**2 + 8*R**2*S**2*U**3*V*t**2 + 16*R**2*S**2*U**3*V*t*w**2 - 16*R**2*S**2*U**3*V*t - 8*R**2*S**2*U**3*V*w**2 + 8*R**2*S**2*U**3*V + 2*R**2*S**2*U**2*V**4*t**2*w**2 + 4*R**2*S**2*U**2*V**4*t**2*w + 2*R**2*S**2*U**2*V**4*t**2 - 4*R**2*S**2*U**2*V**4*t*w**2 - 8*R**2*S**2*U**2*V**4*t*w - 4*R**2*S**2*U**2*V**4*t + 2*R**2*S**2*U**2*V**4*w**2 + 4*R**2*S**2*U**2*V**4*w + 2*R**2*S**2*U**2*V**4 - 24*R**2*S**2*U**2*V**2*t**2*w**2 + 32*R**2*S**2*U**2*V**2*t**2*w - 24*R**2*S**2*U**2*V**2*t**2 + 32*R**2*S**2*U**2*V**2*t*w**2 - 32*R**2*S**2*U**2*V**2*t*w + 32*R**2*S**2*U**2*V**2*t - 24*R**2*S**2*U**2*V**2*w**2 + 32*R**2*S**2*U**2*V**2*w - 24*R**2*S**2*U**2*V**2 + 2*R**2*S**2*U**2*t**2*w**2 + 4*R**2*S**2*U**2*t**2*w + 2*R**2*S**2*U**2*t**2 - 4*R**2*S**2*U**2*t*w**2 - 8*R**2*S**2*U**2*t*w - 4*R**2*S**2*U**2*t + 2*R**2*S**2*U**2*w**2 + 4*R**2*S**2*U**2*w + 2*R**2*S**2*U**2 - 8*R**2*S**2*U*V**3*t**2*w**2 + 8*R**2*S**2*U*V**3*t**2 + 16*R**2*S**2*U*V**3*t*w**2 - 16*R**2*S**2*U*V**3*t - 8*R**2*S**2*U*V**3*w**2 + 8*R**2*S**2*U*V**3 + 8*R**2*S**2*U*V*t**2*w**2 - 8*R**2*S**2*U*V*t**2 - 16*R**2*S**2*U*V*t*w**2 + 16*R**2*S**2*U*V*t + 8*R**2*S**2*U*V*w**2 - 8*R**2*S**2*U*V + 4*R**2*S**2*V**4*t*w**2 + 8*R**2*S**2*V**4*t*w + 4*R**2*S**2*V**4*t + 2*R**2*S**2*V**2*t**2*w**2 + 4*R**2*S**2*V**2*t**2*w + 2*R**2*S**2*V**2*t**2 - 4*R**2*S**2*V**2*t*w**2 - 8*R**2*S**2*V**2*t*w - 4*R**2*S**2*V**2*t + 2*R**2*S**2*V**2*w**2 + 4*R**2*S**2*V**2*w + 2*R**2*S**2*V**2 + 4*R**2*S**2*t*w**2 + 8*R**2*S**2*t*w + 4*R**2*S**2*t + R**2*U**4*V**2*t**2*w**2 + 2*R**2*U**4*V**2*t**2*w + R**2*U**4*V**2*t**2 + 2*R**2*U**4*V**2*t*w**2 + 4*R**2*U**4*V**2*t*w + 2*R**2*U**4*V**2*t + R**2*U**4*V**2*w**2 + 2*R**2*U**4*V**2*w + R**2*U**4*V**2 + 2*R**2*U**2*V**2*t**2*w**2 - 4*R**2*U**2*V**2*t**2*w + 2*R**2*U**2*V**2*t**2 + 4*R**2*U**2*V**2*t*w**2 - 8*R**2*U**2*V**2*t*w + 4*R**2*U**2*V**2*t + 2*R**2*U**2*V**2*w**2 - 4*R**2*U**2*V**2*w + 2*R**2*U**2*V**2 + R**2*V**2*t**2*w**2 + 2*R**2*V**2*t**2*w + R**2*V**2*t**2 + 2*R**2*V**2*t*w**2 + 4*R**2*V**2*t*w + 2*R**2*V**2*t + R**2*V**2*w**2 + 2*R**2*V**2*w + R**2*V**2 + 2*R*S**3*U**3*V**3*t**2*w**2 - 2*R*S**3*U**3*V**3*t**2 - 2*R*S**3*U**3*V**3*w**2 + 2*R*S**3*U**3*V**3 - 2*R*S**3*U**3*V*t**2*w**2 + 2*R*S**3*U**3*V*t**2 + 2*R*S**3*U**3*V*w**2 - 2*R*S**3*U**3*V - 8*R*S**3*U**2*V**2*t**2*w**2 + 16*R*S**3*U**2*V**2*t**2*w - 8*R*S**3*U**2*V**2*t**2 + 8*R*S**3*U**2*V**2*w**2 - 16*R*S**3*U**2*V**2*w + 8*R*S**3*U**2*V**2 - 2*R*S**3*U*V**3*t**2*w**2 + 2*R*S**3*U*V**3*t**2 + 2*R*S**3*U*V**3*w**2 - 2*R*S**3*U*V**3 + 2*R*S**3*U*V*t**2*w**2 - 2*R*S**3*U*V*t**2 - 2*R*S**3*U*V*w**2 + 2*R*S**3*U*V - 2*R*S*U**3*V**3*t**2*w**2 + 2*R*S*U**3*V**3*t**2 + 2*R*S*U**3*V**3*w**2 - 2*R*S*U**3*V**3 + 2*R*S*U**3*V*t**2*w**2 - 2*R*S*U**3*V*t**2 - 2*R*S*U**3*V*w**2 + 2*R*S*U**3*V + 8*R*S*U**2*V**2*t**2*w**2 - 16*R*S*U**2*V**2*t**2*w + 8*R*S*U**2*V**2*t**2 - 8*R*S*U**2*V**2*w**2 + 16*R*S*U**2*V**2*w - 8*R*S*U**2*V**2 + 2*R*S*U*V**3*t**2*w**2 - 2*R*S*U*V**3*t**2 - 2*R*S*U*V**3*w**2 + 2*R*S*U*V**3 - 2*R*S*U*V*t**2*w**2 + 2*R*S*U*V*t**2 + 2*R*S*U*V*w**2 - 2*R*S*U*V + 4*S**4*U**2*V**2*t**2*w + 8*S**4*U**2*V**2*t*w + 4*S**4*U**2*V**2*w + S**2*U**2*V**4*t**2*w**2 + 2*S**2*U**2*V**4*t**2*w + S**2*U**2*V**4*t**2 + 2*S**2*U**2*V**4*t*w**2 + 4*S**2*U**2*V**4*t*w + 2*S**2*U**2*V**4*t + S**2*U**2*V**4*w**2 + 2*S**2*U**2*V**4*w + S**2*U**2*V**4 + 2*S**2*U**2*V**2*t**2*w**2 - 4*S**2*U**2*V**2*t**2*w + 2*S**2*U**2*V**2*t**2 + 4*S**2*U**2*V**2*t*w**2 - 8*S**2*U**2*V**2*t*w + 4*S**2*U**2*V**2*t + 2*S**2*U**2*V**2*w**2 - 4*S**2*U**2*V**2*w + 2*S**2*U**2*V**2 + S**2*U**2*t**2*w**2 + 2*S**2*U**2*t**2*w + S**2*U**2*t**2 + 2*S**2*U**2*t*w**2 + 4*S**2*U**2*t*w + 2*S**2*U**2*t + S**2*U**2*w**2 + 2*S**2*U**2*w + S**2*U**2 + 4*U**2*V**2*t**2*w + 8*U**2*V**2*t*w + 4*U**2*V**2*w");
		positive(f);
	}
}